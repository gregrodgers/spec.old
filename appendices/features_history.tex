% This is features_history.tex (Appendix E) of the OpenMP specification.
% This is an included file. See the master file for more information.
%
% When editing this file:
%
%    1. To change formatting, appearance, or style, please edit openmp.sty.
%
%    2. Custom commands and macros are defined in openmp.sty.
%
%    3. Be kind to other editors -- keep a consistent style by copying-and-pasting to
%       create new content.
%
%    4. We use semantic markup, e.g. (see openmp.sty for a full list):
%         \code{}     % for bold monospace keywords, code, operators, etc.
%         \plc{}      % for italic placeholder names, grammar, etc.
%
%    5. There are environments that provide special formatting, e.g. language bars.
%       Please use them whereever appropriate.  Examples are:
%
%         \begin{fortranspecific}
%         This is text that appears enclosed in blue language bars for Fortran.
%         \end{fortranspecific}
%
%         \begin{note}
%         This is a note.  The "Note -- " header appears automatically.
%         \end{note}
%
%    6. Other recommendations:
%         Use the convenience macros defined in openmp.sty for the minor headers
%         such as Comments, Syntax, etc.
%
%         To keep items together on the same page, prefer the use of 
%         \begin{samepage}.... Avoid \parbox for text blocks as it interrupts line numbering.
%         When possible, avoid \filbreak, \pagebreak, \newpage, \clearpage unless that's
%         what you mean. Use \needspace{} cautiously for troublesome paragraphs.
%
%         Avoid absolute lengths and measures in this file; use relative units when possible.
%         Vertical space can be relative to \baselineskip or ex units. Horizontal space
%         can be relative to \linewidth or em units.
%
%         Prefer \emph{} to italicize terminology, e.g.:
%             This is a \emph{definition}, not a placeholder.
%             This is a \plc{var-name}.
%


\chapter{Features History}
\index{features history}
\index{history of features}
\label{chap:Features History}
This appendix summarizes the major changes between recent versions of the OpenMP 
API since version 2.5.

\section{Deprecated Features}
\index{deprecated features}
\label{chap:Deprecated Features}

The following features have been deprecated:

\begin{itemize}
\item the \plc{nest-var} ICV;
\item the \code{OMP\_NESTED} environment variable;
\item the \code{omp\_set\_nested} and \code{omp\_get\_nested} routines;
\item and the \code{omp\_lock\_hint\_t} type.
\end{itemize}



\section{Version 4.5 to 5.0 Differences}
\label{sec:Version 4.5 to 5.0 Differences}
\begin{itemize}
\item The memory model was extended to distinguish different types of flush
    operations according to specified flush properties (see
    \specref{subsec:The Flush Operation}) and to define a happens before order
    based on synchronizing flush operations (see \specref{subsec:happens-before}).

\item The default value of the \plc{nest-var} ICV was changed from \plc{false} to implementation defined (see \specref{subsec:ICV Initialization}).
The \plc{nest-var} ICV (see \specref{subsec:ICV Descriptions}), the \code{OMP\_NESTED} environment variable (see \specref{sec:OMP_NESTED}), and the \code{omp\_set\_nested} and \code{omp\_get\_nested} routines were deprecated (see \specref{subsec:omp_set_nested} and \specref{subsec:omp_get_nested}).

\item The list items allowable in a \code{depend} clause on a task generating
      construct was extended, including for C/C++ allowing any \plc{lvalue} expression (see
      \specref{sec:Directive Format} and \specref{subsec:depend Clause}).

\item The \plc{relational-op} in the canonical loop form for C/C++ was
extended to include != (see \specref{sec:Canonical Loop Form}).
  
\item To support taskloop reductions, the \code{reduction} and
\code{in\_reduction} clauses were added to the \code{taskloop} (see
\specref{subsec:taskloop Construct}) and \code{taskloop simd} (see
\specref{subsec:taskloop simd Construct}) constructs.

\item To reduce programmer effort implicit declare target directives for
some functions (C, C++, Fortran) and subroutines (Fortran) were added (see
\specref{subsec:target Construct} and \specref{subsec:declare target
Directive}).

\item The \code{depend} clause was added to the \code{taskwait} construct (see
\specref{subsec:taskwait Construct}).

\item To support acquire and release semantics with weak memory ordering, the
    \code{acq\_rel}, \code{acquire}, and \code{release} clauses were added to
    the \code{atomic} construct (see \specref{subsec:atomic Construct}) and
    \code{flush} construct (see \specref{subsec:flush Construct}).

\item The \code{atomic} construct was extended with the \code{hint} clause (see \specref{subsec:atomic Construct}).

\item The lock hints were renamed to synchronization hints, and the
  old names were deprecated (see \specref{subsec:Synchronization Hints}).

\item To support conditional assignment to lastprivate variables, the
\code{conditional} modifier was added to the \code{lastprivate} clause (see
\specref{subsubsec:lastprivate clause}).

\item To support task reductions, the \code{task\_reduction}
clause was added to the \code{taskgroup} construct (see \specref{subsubsec:task_reduction clause}) and the \code{in\_reduction}
clause to the \code{task} construct (see \specref{subsubsec:in_reduction clause}).

%% \item Support for a tool interface was added (see \specref{chap:ToolsSupport} for the principal description of the tool interface). 
%% BRONIS: THe above is unnecessarily verbos
\item Support for a tool interface was added (see \specref{chap:ToolsSupport}).
\end{itemize}


\section{Version 4.0 to 4.5 Differences}
\label{sec:Version 4.0 to 4.5 Differences}
\begin{itemize}
\item Support for several features of Fortran 2003 was added (see 
      \specref{sec:normative references} for features that are still 
      not supported).

\item A parameter was added to the \code{ordered} clause of the loop construct 
      (see \specref{subsec:Loop Construct}) and clauses were added to the 
      \code{ordered} construct (see \specref{subsec:ordered Construct}) to 
      support doacross loop nests and use of the \code{simd} construct on 
      loops with loop-carried backward dependences. 

\item The \code{linear} clause was added to the loop construct 
      (see \specref{subsec:Loop Construct}).

\item The \code{simdlen} clause was added to the \code{simd} construct
      (see \specref{subsec:simd Construct}) to support specification of 
      the exact number of iterations desired per SIMD chunk. 

\item The \code{priority} clause was added to the \code{task} construct
      (see \specref{subsec:task Construct}) to support hints that specify
      the relative execution priority of explicit tasks. The 
      \code{omp\_get\_max\_task\_priority} routine was added to return
      the maximum supported priority value (see 
      \specref{subsec:omp_get_max_task_priority}) and the 
      \code{OMP\_MAX\_TASK\_PRIORITY} environment variable was added to
      control the maximum priority value allowed (see 
      \specref{sec:OMP_MAX_TASK_PRIORITY}).

\item Taskloop constructs (see \specref{subsec:taskloop Construct} and 
      \specref{subsec:taskloop simd Construct}) were added to support 
      nestable parallel loops that create OpenMP tasks. 

\item To support interaction with native device implementations, the 
      \code{use\_device\_ptr} clause was added to the \code{target\ data}
      construct (see \specref{subsec:target data Construct}) and the 
      \code{is\_device\_ptr} clause was added to the \code{target} construct
      (see \specref{subsec:target Construct}).

\item The \code{nowait} and \code{depend} clauses were added to the 
      \code{target} construct (see \specref{subsec:target Construct}) 
      to improve support for asynchronous execution of \code{target} regions. 

\item The \code{private}, \code{firstprivate} and \code{defaultmap} clauses 
      were added to the \code{target} construct (see \specref{subsec:target 
      Construct}).

\item The \code{declare}~\code{target} directive was extended to allow 
      mapping of global variables to be deferred to specific device 
      executions and to allow an \plc{extended-list}
      to be specified in C/C++ (see \specref{subsec:declare target Directive}).

\item To support unstructured data mapping for devices, the 
      \code{target enter data} (see \specref{subsec:target enter data 
      Construct}) and \code{target exit data} (see \specref{subsec:target 
      exit data Construct}) constructs were added and the \code{map} clause 
      (see \specref{subsec:map Clause}) was updated.

\item To support a more complete set of device construct shortcuts, the
      \code{target}~\code{parallel} 
      (see \specref{subsec:target parallel Construct}), 
      target parallel loop 
      (see \specref{subsec:Target Parallel Loop Construct}),
      target parallel loop SIMD 
      (see \specref{subsec:Target Parallel Loop SIMD Construct}),
      and \code{target}~\code{simd} 
      (see \specref{subsec:target simd Construct}),
      combined constructs were added.

\item The \code{if} clause was extended to take a
      \plc{directive-name-modifier} that allows it to apply
      to combined constructs (see \specref{sec:if Clause}).

\item The \code{hint} clause was addded to the \code{critical} construct
      (see \specref{subsec:critical Construct}).

\item The \code{source} and \code{sink} dependence types were added to the 
      \code{depend} clause (see \specref{subsec:depend Clause}) to support 
      doacross loop nests. 

\item The implicit data-sharing attribute for scalar variables in 
      \code{target} regions was changed to \code{firstprivate} (see 
      \specref{subsubsec:Data-sharing Attribute Rules for Variables 
      Referenced in a Construct}).
	 
\item Use of some C++ reference types was allowed in some data sharing 
      attribute clauses (see \specref{subsec:Data-Sharing Attribute Clauses}).

\item Semantics for reductions on C/C++ array sections were added and 
      restrictions on the use of arrays and pointers in reductions were 
      removed (see \specref{subsubsec:reduction clause}).
      
\item The \code{ref}, \code{val}, and \code{uval} modifiers were added to the
      \code{linear} clause (see \specref{subsubsec:linear clause}).
      
\item Support was added to the map clauses to handle structure elements 
	(see \specref{subsec:map Clause}).
	  
\item Query functions for OpenMP thread affinity were added (see 
      \specref{subsec:omp_get_num_places} to \specref{subsec:omp_get_partition_place_nums}).

\item The lock API was extended with lock routines that support storing a hint
      with a lock to select a desired lock implementation for a lock's intended usage
      by the application code (see \specref{subsec:omp_init_lock_with_hint and omp_init_nest_lock_with_hint}).

\item Device memory routines were added to allow explicit allocation, 
      deallocation, memory transfers and memory associations (see
      \specref{sec:Device Memory Routines}).

\item C/C++ Grammar (previously Appendix B) was moved to a separate document. 
\end{itemize}



\section{Version 3.1 to 4.0 Differences}
\label{sec:Version 3.1 to 4.0 Differences}
\begin{itemize}
\item Various changes throughout the specification were made to provide initial support of 
Fortran 2003 (see 
\specref{sec:normative references}). 

\item C/C++ array syntax was extended to support array sections (see
\specref{sec:Array Sections}). 

\item The \code{proc\_bind} clause (see 
\specref{subsec:Controlling OpenMP Thread Affinity}), 
the \code{OMP\_PLACES} 
environment variable (see 
\specref{sec:OMP_PLACES}), and the \code{omp\_get\_proc\_bind} 
runtime routine (see 
\specref{subsec:omp_get_proc_bind}) 
were added to support thread 
affinity policies. 

\item SIMD constructs were added to support SIMD parallelism (see 
\specref{sec:SIMD Constructs}). 

\item Device constructs (see 
\specref{sec:Device Constructs}), 
the \code{OMP\_DEFAULT\_DEVICE} 
environment variable (see 
\specref{sec:OMP_DEFAULT_DEVICE}), the 
\code{omp\_set\_default\_device}, \code{omp\_get\_default\_device}, 
\code{omp\_get\_num\_devices}, \code{omp\_get\_num\_teams}, \code{omp\_get\_team\_num}, and 
\code{omp\_is\_initial\_device} routines were added to support execution on devices. 

\item Implementation defined task scheduling points for untied tasks were removed (see 
\specref{subsec:Task Scheduling}). 

\item The \code{depend} clause (see 
\specref{subsec:depend Clause}) 
was added to support task dependences. 

\item The \code{taskgroup} construct (see 
\specref{subsec:taskgroup Construct}) was added to support 
more flexible deep task synchronization. 

\item The \code{reduction} clause (see 
\specref{subsubsec:reduction clause}) was extended and the 
\code{declare}~\code{reduction} construct (see 
\specref{sec:declare reduction Directive}) was added to 
support user defined reductions.

\item The \code{atomic} construct (see 
\specref{subsec:atomic Construct}) was extended to support 
atomic swap with the \code{capture} clause, to allow new atomic update and capture 
forms, and to support sequentially consistent atomic operations with a new \code{seq\_cst} 
clause. 

\item The \code{cancel} construct (see 
\specref{subsec:cancel Construct}), the \code{cancellation}~\code{point} construct (see 
\specref{subsec:cancellation point Construct}), 
the \code{omp\_get\_cancellation} 
runtime routine (see 
\specref{subsec:omp_get_cancellation}) 
and the \code{OMP\_CANCELLATION} 
environment variable (see 
\specref{sec:OMP_CANCELLATION}) were added to support the 
concept of cancellation. 

\item The \code{OMP\_DISPLAY\_ENV} environment variable (see 
\specref{sec:OMP_DISPLAY_ENV}) was 
added to display the value of ICVs associated with the OpenMP environment 
variables. 

\item Examples (previously Appendix A) were moved to a separate document. 
\end{itemize}






\section{Version 3.0 to 3.1 Differences}
\label{sec:Version 3.0 to 3.1 Differences}
\begin{itemize}
\item The \code{final} and \code{mergeable} clauses (see 
\specref{subsec:task Construct}) were added to 
the \code{task} construct to support optimization of task data environments.

\item The \code{taskyield} construct (see 
\specref{subsec:taskyield Construct}) was added to allow 
user-defined task scheduling points.

\item The \code{atomic} construct (see 
\specref{subsec:atomic Construct}) was extended to include 
\code{read}, \code{write}, and \code{capture} forms, and an \code{update} clause was added to apply 
the already existing form of the \code{atomic} construct.

\item Data environment restrictions were changed to allow \code{intent(in)} and 
\code{const}-qualified types for the \code{firstprivate} clause (see 
\specref{subsubsec:firstprivate clause}).

\item Data environment restrictions were changed to allow Fortran pointers in 
\code{firstprivate} (see 
\specref{subsubsec:firstprivate clause}) 
and \code{lastprivate} (see 
\specref{subsubsec:lastprivate clause}).

\item New reduction operators \code{min} and \code{max} were added for C and C++ 

\item The nesting restrictions in 
\specref{sec:Nesting of Regions} were clarified to disallow 
closely-nested OpenMP regions within an \code{atomic} region. This allows an \code{atomic} 
region to be consistently defined with other OpenMP regions so that they include all 
code in the atomic construct.

\item The \code{omp\_in\_final} runtime library routine (see 
\specref{subsec:omp_in_final}) was 
added to support specialization of final task regions.

\item The \plc{nthreads-var} ICV has been modified to be a list of the number of threads to use 
at each nested parallel region level. The value of this ICV is still set with the 
\code{OMP\_NUM\_THREADS} environment variable (see 
\specref{sec:OMP_NUM_THREADS}), but the 
algorithm for determining the number of threads used in a parallel region has been 
modified to handle a list (see 
\specref{subsec:Determining the Number of Threads for a parallel Region}).

\item The \plc{bind-var} ICV has been added, which controls whether or not threads are bound 
to processors (see 
\specref{subsec:ICV Descriptions}). 
The value of this ICV can be set with 
the \code{OMP\_PROC\_BIND} environment variable (see 
\specref{sec:OMP_PROC_BIND}).

\item Descriptions of examples (previously Appendix A) were expanded and 
clarified.

\item Replaced incorrect use of \code{omp\_integer\_kind} in Fortran interfaces (see 
\specref{sec:Example of a Fortran Interface Declaration module} 
and \specref{sec:Example of a Generic Interface for a Library Routine}) with 
\code{selected\_int\_kind(8)}. 
\end{itemize}







\section{Version 2.5 to 3.0 Differences}
\label{sec:Version 2.5 to 3.0 Differences}
The concept of tasks has been added to the OpenMP execution model (see 
\specref{subsec:Tasking Terminology} and 
\specref{sec:Execution Model}). 

\begin{itemize}
\item The \code{task} construct (see 
\specref{sec:Tasking Constructs}) 
has been added, which provides 
a mechanism for creating tasks explicitly. 

\item The \code{taskwait} construct (see 
\specref{subsec:taskwait Construct}) has been added, which 
causes a task to wait for all its child tasks to complete. 

\item The OpenMP memory model now covers atomicity of memory accesses (see 
\specref{subsec:Structure of the OpenMP Memory Model}). 
The description of the behavior of \code{volatile} in terms of 
\code{flush} was removed.

\item In Version 2.5, there was a single copy of the \plc{nest-var}, \plc{dyn-var}, \plc{nthreads-var} and 
\plc{run-sched-var} internal control variables (ICVs) for the whole program. In Version 
3.0, there is one copy of these ICVs per task (see 
\specref{sec:Internal Control Variables}). As a result, 
the \code{omp\_set\_num\_threads}, \code{omp\_set\_nested} and \code{omp\_set\_dynamic} 
runtime library routines now have specified effects when called from inside a 
\code{parallel} region (see 
\specref{subsec:omp_set_num_threads}, 
\specref{subsec:omp_set_dynamic} and 
\specref{subsec:omp_set_nested}). 

\item The definition of active \code{parallel} region has been changed: in Version 3.0 a 
\code{parallel} region is active if it is executed by a team consisting of more than one 
thread (see 
\specref{subsec:OpenMP Language Terminology}). 

\item The rules for determining the number of threads used in a \code{parallel} region have 
been modified (see 
\specref{subsec:Determining the Number of Threads for a parallel Region}). 

\item In Version 3.0, the assignment of iterations to threads in a loop construct with a 
\code{static} schedule kind is deterministic (see 
\specref{subsec:Loop Construct}). 

\item In Version 3.0, a loop construct may be associated with more than one perfectly 
nested loop. The number of associated loops may be controlled by the \code{collapse} 
clause (see 
\specref{subsec:Loop Construct}). 

\item Random access iterators, and variables of unsigned integer type, may now be used as 
loop iterators in loops associated with a loop construct (see 
\specref{subsec:Loop Construct}). 

\item The schedule kind \code{auto} has been added, which gives the implementation the 
freedom to choose any possible mapping of iterations in a loop construct to threads in 
the team (see \specref{subsec:Loop Construct}).

\item Fortran assumed-size arrays now have predetermined data-sharing attributes (see 
\specref{subsubsec:Data-sharing Attribute Rules for Variables Referenced in a Construct}).

\item In Fortran, \code{firstprivate} is now permitted as an argument to the \code{default} 
clause (see 
\specref{subsubsec:default clause}).

\item For list items in the \code{private} clause, implementations are no longer permitted to use 
the storage of the original list item to hold the new list item on the master thread. If 
no attempt is made to reference the original list item inside the \code{parallel} region, its 
value is well defined on exit from the \code{parallel} region (see 
\specref{subsubsec:private clause}).

\item In Version 3.0, Fortran allocatable arrays may appear in \code{private}, 
\code{firstprivate}, \code{lastprivate}, \code{reduction}, \code{copyin} and \code{copyprivate} 
clauses. (see 
\specref{subsec:threadprivate Directive}, 
\specref{subsubsec:private clause}, 
\specref{subsubsec:firstprivate clause}, 
\specref{subsubsec:lastprivate clause},
\specref{subsubsec:reduction clause}, 
\specref{subsubsec:copyin clause} and 
\specref{subsubsec:copyprivate clause}). 

\item In Version 3.0, static class members variables may appear in a \code{threadprivate} 
directive (see 
\specref{subsec:threadprivate Directive}). 

\item Version 3.0 makes clear where, and with which arguments, constructors and 
destructors of private and threadprivate class type variables are called (see 
\specref{subsec:threadprivate Directive}, 
\specref{subsubsec:private clause}, 
\specref{subsubsec:firstprivate clause},
\specref{subsubsec:copyin clause} and 
\specref{subsubsec:copyprivate clause}).

\item The runtime library routines \code{omp\_set\_schedule} and \code{omp\_get\_schedule} 
have been added; these routines respectively set and retrieve the value of the 
\plc{run-sched-var} ICV (see\\
\specref{subsec:omp_set_schedule} and 
\specref{subsec:omp_get_schedule}).

\item The \plc{thread-limit-var} ICV has been added, which controls the maximum number of 
threads participating in the OpenMP program. The value of this ICV can be set with 
the \code{OMP\_THREAD\_LIMIT} environment variable and retrieved with the 
\code{omp\_get\_thread\_limit} runtime library routine (see 
\specref{subsec:ICV Descriptions}, 
\specref{subsec:omp_get_thread_limit} and 
\specref{sec:OMP_THREAD_LIMIT}).

\item The \plc{max-active-levels-var} ICV has been added, which controls the number of nested 
active \code{parallel} regions. The value of this ICV can be set with the 
\code{OMP\_MAX\_ACTIVE\_LEVELS} environment variable and the 
\code{omp\_set\_max\_active\_levels} runtime library routine, and it can be retrieved
with the omp\_get\_max\_active\_levels runtime library routine (see 
\specref{subsec:ICV Descriptions}, 
\specref{subsec:omp_set_max_active_levels}, 
\specref{subsec:omp_get_max_active_levels} and 
\specref{sec:OMP_MAX_ACTIVE_LEVELS}).

\item The \plc{stacksize-var} ICV has been added, which controls the stack size for threads that 
the OpenMP implementation creates. The value of this ICV can be set with the 
\code{OMP\_STACKSIZE} environment variable (see 
\specref{subsec:ICV Descriptions} and 
\specref{sec:OMP_STACKSIZE}).

\item The \plc{wait-policy-var} ICV has been added, which controls the desired behavior of 
waiting threads. The value of this ICV can be set with the \code{OMP\_WAIT\_POLICY} 
environment variable (see 
\specref{subsec:ICV Descriptions} and 
\specref{sec:OMP_WAIT_POLICY}).

\item The \code{omp\_get\_level} runtime library routine has been added, which returns the 
number of nested \code{parallel} regions enclosing the task that contains the call (see 
\specref{subsec:omp_get_level}). 

\item The \code{omp\_get\_ancestor\_thread\_num} runtime library routine has been added, 
which returns, for a given nested level of the current thread, the thread number of the 
ancestor (see 
\specref{subsec:omp_get_ancestor_thread_num}).

\item The \code{omp\_get\_team\_size} runtime library routine has been added, which returns, 
for a given nested level of the current thread, the size of the thread team to which the 
ancestor belongs (see 
\specref{subsec:omp_get_team_size}).

\item The \code{omp\_get\_active\_level} runtime library routine has been added, which 
returns the number of nested, active \code{parallel} regions enclosing the task that 
contains the call (see\linebreak \specref{subsec:omp_get_active_level}).

\item In Version 3.0, locks are owned by tasks, not by threads (see 
\specref{sec:Lock Routines}). 
\end{itemize}


% This is the end of appendix-E-FeaturesHistory.tex

