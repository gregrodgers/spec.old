% This is environment_variables.tex (Chapter 5) of the OpenMP specification.
% This is an included file. See the master file for more information.
%
% When editing this file:
%
%    1. To change formatting, appearance, or style, please edit openmp.sty.
%
%    2. Custom commands and macros are defined in openmp.sty.
%
%    3. Be kind to other editors -- keep a consistent style by copying-and-pasting to
%       create new content.
%
%    4. We use semantic markup, e.g. (see openmp.sty for a full list):
%         \code{}     % for bold monospace keywords, code, operators, etc.
%         \plc{}      % for italic placeholder names, grammar, etc.
%
%    5. There are environments that provide special formatting, e.g. language bars.
%       Please use them whereever appropriate.  Examples are:
%
%         \begin{fortranspecific}
%         This is text that appears enclosed in blue language bars for Fortran.
%         \end{fortranspecific}
%
%         \begin{note}
%         This is a note.  The "Note -- " header appears automatically.
%         \end{note}
%
%    6. Other recommendations:
%         Use the convenience macros defined in openmp.sty for the minor headers
%         such as Comments, Syntax, etc.
%
%         To keep items together on the same page, prefer the use of
%         \begin{samepage}.... Avoid \parbox for text blocks as it interrupts line numbering.
%         When possible, avoid \filbreak, \pagebreak, \newpage, \clearpage unless that's
%         what you mean. Use \needspace{} cautiously for troublesome paragraphs.
%
%         Avoid absolute lengths and measures in this file; use relative units when possible.
%         Vertical space can be relative to \baselineskip or ex units. Horizontal space
%         can be relative to \linewidth or em units.
%
%         Prefer \emph{} to italicize terminology, e.g.:
%             This is a \emph{definition}, not a placeholder.
%             This is a \plc{var-name}.
%

\chapter{Environment Variables}
\index{environment variables}
\index{variables, environment}
\label{chap:Environment Variables}
This chapter describes the OpenMP environment variables that specify the settings of
the ICVs that affect the execution of OpenMP programs (see \specref{sec:Internal Control Variables}).
The names of the environment variables must be upper case. The values assigned to the
environment variables are case insensitive and may have leading and trailing white
space. Modifications to the environment variables after the program has started, even if
modified by the program itself, are ignored by the OpenMP implementation. However,
the settings of some of the ICVs can be modified during the execution of the OpenMP
program by the use of the appropriate directive clauses or OpenMP API routines.

The following examples demonstrate how the OpenMP environment variables can
be set in different environments:

\begin{itemize}
\item csh-like shells:
\end{itemize}

\begin{ompEnv}
setenv OMP_SCHEDULE "dynamic"
\end{ompEnv}

\begin{itemize}
\item bash-like shells:
\end{itemize}

\begin{ompEnv}
export OMP_SCHEDULE="dynamic"
\end{ompEnv}

\begin{itemize}
\item Windows Command Line:
\end{itemize}

\begin{ompEnv}
set OMP_SCHEDULE=dynamic
\end{ompEnv}


\section{\hcode{OMP_SCHEDULE}}
\index{OMP_SCHEDULE@{\code{OMP_SCHEDULE}}}
\index{environment variables!OMP_SCHEDULE@{\code{OMP_SCHEDULE}}}
\label{sec:OMP_SCHEDULE}
The \code{OMP_SCHEDULE} environment variable controls the schedule kind and chunk size
of all loop directives that have the schedule kind \code{runtime}, by setting the value of the
\plc{run-sched-var} ICV.

The value of this environment variable takes the form:

\plc{[}\plc{modifier}:\plc{]}\plc{kind}\plc{[},\plc{ chunk}\plc{]}

where

\begin{itemize}
\item \plc{modifier} is one of \code{monotonic} or \code{nonmonotonic};

\item \plc{kind} is one of \code{static}, \code{dynamic}, \code{guided}, or \code{auto};

\item \plc{chunk} is an optional positive integer that specifies the chunk size.
\end{itemize}

If the \plc{modifier} is not present, the \plc{modifier} is set to \code{monotonic} if \plc{kind} is \code{static}; for any other \plc{kind} it is set to \code{nonmonotonic}.

If \plc{chunk} is present, there may be white space on either side of the ``\code{,}''. See
\specref{subsec:Worksharing-Loop Construct} for a detailed description of the schedule kinds.

The behavior of the program is implementation defined if the value of \code{OMP_SCHEDULE}
does not conform to the above format.

Implementation specific schedules cannot be specified in \code{OMP_SCHEDULE}. They can
only be specified by calling \code{omp_set_schedule}, described in \specref{subsec:omp_set_schedule}.

Examples:

\begin{ompEnv}
setenv OMP_SCHEDULE "guided,4"
setenv OMP_SCHEDULE "dynamic"
setenv OMP_SCHEDULE "nonmonotonic:dynamic,4"
\end{ompEnv}

\crossreferences
\begin{itemize}
\item \plc{run-sched-var} ICV, see \specref{sec:Internal Control Variables}.

\item Worksharing-Loop construct, see \specref{subsec:Worksharing-Loop Construct}.

\item Parallel worksharing-loop construct, see \specref{subsec:Parallel Worksharing-Loop Construct}.

\item \code{omp_set_schedule} routine, see \specref{subsec:omp_set_schedule}.

\item \code{omp_get_schedule} routine, see \specref{subsec:omp_get_schedule}.
\end{itemize}









\section{\hcode{OMP_NUM_THREADS}}
\index{OMP_NUM_THREADS@{\code{OMP_NUM_THREADS}}}
\index{environment variables!OMP_NUM_THREADS@{\code{OMP_NUM_THREADS}}}
\label{sec:OMP_NUM_THREADS}
The \code{OMP_NUM_THREADS} environment variable sets the number of threads to use for
\code{parallel} regions by setting the initial value of the \plc{nthreads-var} ICV. See
\specref{sec:Internal Control Variables} for a comprehensive set of rules about the interaction between the
\code{OMP_NUM_THREADS} environment variable, the \code{num_threads} clause, the
\code{omp_set_num_threads} library routine and dynamic adjustment of threads, and
\specref{subsec:Determining the Number of Threads for a parallel Region}
for a complete algorithm that describes how the number of
threads for a \code{parallel} region is determined.

The value of this environment variable must be a list of positive integer values. The
values of the list set the number of threads to use for \code{parallel} regions at the
corresponding nested levels.

The behavior of the program is implementation defined if any value of the list specified
in the \code{OMP_NUM_THREADS} environment variable leads to a number of threads which is
greater than an implementation can support, or if any value is not a positive integer.

Example:
\begin{ompEnv}
setenv OMP_NUM_THREADS 4,3,2
\end{ompEnv}

\crossreferences
\begin{itemize}
\item \plc{nthreads-var} ICV, see \specref{sec:Internal Control Variables}.

\item \code{num_threads} clause, \specref{sec:parallel Construct}.

\item \code{omp_set_num_threads} routine, see \specref{subsec:omp_set_num_threads}.

\item \code{omp_get_num_threads} routine, see \specref{subsec:omp_get_num_threads}.

\item \code{omp_get_max_threads} routine, see \specref{subsec:omp_get_max_threads}.

\item \code{omp_get_team_size} routine, see \specref{subsec:omp_get_team_size}.
\end{itemize}







\section{\hcode{OMP_DYNAMIC}}
\index{OMP_DYNAMIC@{\code{OMP_DYNAMIC}}}
\index{environment variables!OMP_DYNAMIC@{\code{OMP_DYNAMIC}}}
\label{sec:OMP_DYNAMIC}
The \code{OMP_DYNAMIC} environment variable controls dynamic adjustment of the number
of threads to use for executing \code{parallel} regions by setting the initial value of the
\plc{dyn-var} ICV. The value of this environment variable must be \code{true} or \code{false}. If the
environment variable is set to \code{true}, the OpenMP implementation may adjust the
number of threads to use for executing \code{parallel} regions in order to optimize the use
of system resources. If the environment variable is set to \code{false}, the dynamic
adjustment of the number of threads is disabled. The behavior of the program is
implementation defined if the value of \code{OMP_DYNAMIC} is neither \code{true} nor \code{false}.

Example:
\begin{ompEnv}
setenv OMP_DYNAMIC true
\end{ompEnv}

\crossreferences
\begin{itemize}
\item \plc{dyn-var} ICV, see \specref{sec:Internal Control Variables}.

\item \code{omp_set_dynamic} routine, see \specref{subsec:omp_set_dynamic}.

\item \code{omp_get_dynamic} routine, see \specref{subsec:omp_get_dynamic}.
\end{itemize}









\section{\hcode{OMP_PROC_BIND}}
\index{OMP_PROC_BIND@{\code{OMP_PROC_BIND}}}
\index{environment variables!OMP_PROC_BIND@{\code{OMP_PROC_BIND}}}
\label{sec:OMP_PROC_BIND}
The \code{OMP_PROC_BIND} environment variable sets the initial value of the \plc{bind-var} ICV.
The value of this environment variable is either \code{true}, \code{false}, or a comma separated
list of \code{master}, \code{close}, or \code{spread}. The values of the list set the thread affinity policy
to be used for parallel regions at the corresponding nested level.

If the environment variable is set to \code{false}, the execution environment may move
OpenMP threads between OpenMP places, thread affinity is disabled, and \code{proc_bind}
clauses on \code{parallel} constructs are ignored.

Otherwise, the execution environment should not move OpenMP threads between
OpenMP places, thread affinity is enabled, and the initial thread is bound to the first
place in the OpenMP place list prior to the first active parallel region.

The behavior of the program is implementation defined if the value in the
\code{OMP_PROC_BIND} environment variable is not \code{true}, \code{false}, or a comma separated
list of \code{master}, \code{close}, or \code{spread}. The behavior is also implementation defined if an
initial thread cannot be bound to the first place in the OpenMP place list.

\pagebreak

Examples:
\begin{ompEnv}
setenv OMP_PROC_BIND false
setenv OMP_PROC_BIND "spread, spread, close"
\end{ompEnv}


\crossreferences
\begin{itemize}
\item \plc{bind-var} ICV, see \specref{sec:Internal Control Variables}.

\item \code{proc_bind} clause, see \specref{subsec:Controlling OpenMP Thread Affinity}.

\item \code{omp_get_proc_bind} routine, see \specref{subsec:omp_get_proc_bind}.
\end{itemize}









\section{\hcode{OMP_PLACES}}
\index{OMP_PLACES@{\code{OMP_PLACES}}}
\index{environment variables!OMP_PLACES@{\code{OMP_PLACES}}}
\label{sec:OMP_PLACES}
A list of places can be specified in the \code{OMP_PLACES} environment variable. The
\plc{place-partition-var} ICV obtains its initial value from the \code{OMP_PLACES} value, and makes the
list available to the execution environment. The value of \code{OMP_PLACES} can be one of
two types of values: either an abstract name describing a set of places or an explicit list
of places described by non-negative numbers.

The \code{OMP_PLACES} environment variable can be defined using an explicit ordered list of
comma-separated places. A place is defined by an unordered set of comma-separated
non-negative numbers enclosed by braces. The meaning of the numbers and how the
numbering is done are implementation defined. Generally, the numbers represent the
smallest unit of execution exposed by the execution environment, typically a hardware
thread.

Intervals may also be used to define places. Intervals can be specified using the
<\plc{lower-bound}> : <\plc{length}> : <\plc{stride}> notation to represent the following list of numbers:
``<\plc{lower-bound}>, <\plc{lower-bound}> + <\plc{stride}>, ..., <\plc{lower-bound}> + (<\plc{length}>-
1)*<\plc{stride}>.'' When <\plc{stride}> is omitted, a unit stride is assumed. Intervals can specify
numbers within a place as well as sequences of places.

An exclusion operator ``\code{!}'' can also be used to exclude the number or place immediately
following the operator.

Alternatively, the abstract names listed in
Table~\ref{tab:Defined Abstract Names for OMP PLACES} should be understood
by the execution and runtime environment. The precise definitions of the
abstract names are implementation defined. An implementation may also add
abstract names as appropriate for the target platform.

The abstract name may be appended by a positive number in parentheses to denote the
length of the place list to be created, that is \plc{abstract_name(num-places)}. When
requesting fewer places than available on the system, the determination of which
resources of type \plc{abstract_name} are to be included in the place list is implementation
defined. When requesting more resources than available, the length of the place list is
implementation defined.

% Table

\medskip
\nolinenumbers
\renewcommand{\arraystretch}{1.5}
\tablefirsthead{%
\hline
\textsf{\textbf{Abstract Name}} & \textsf{\textbf{Meaning}}\\
\hline
}
\tablehead{%
\multicolumn{2}{l}{\small\slshape table continued from previous page}\\
\hline\\
\textsf{\textbf{Abstract Name}} & \textsf{\textbf{Meaning}}\\
\hline
}
\tabletail{%
\hline\\
\multicolumn{2}{l}{\small\slshape table continued on next page}\\
}
\tablelasttail{\hline}
\tablecaption{Defined Abstract Names for \code{OMP_PLACES}\label{tab:Defined Abstract Names for OMP PLACES}}
\begin{supertabular}{p{1.5in} p{3.5in}}
{\scode{threads}} & Each place corresponds to a single hardware thread on the target machine.\\
{\scode{cores}} & Each place corresponds to a single core (having one or more hardware
threads) on the target machine.\\
{\scode{sockets}} & Each place corresponds to a single socket (consisting of one or more cores)
on the target machine.\\
\end{supertabular}

\linenumbers

The behavior of the program is implementation defined when the execution environment
cannot map a numerical value (either explicitly defined or implicitly derived from an
interval) within the \code{OMP_PLACES} list to a processor on the target platform, or if it maps
to an unavailable processor. The behavior is also implementation defined when the
\code{OMP_PLACES} environment variable is defined using an abstract name.

The following grammar describes the values accepted for the \code{OMP_PLACES} environment
variable.

\begin{bnf*}
   \bnfprod{list}{
      \bnfpn{p-list} \bnfor
      \bnfpn{aname}
      } \\
   \bnfprod{p-list}{
      \bnfpn{p-interval} \bnfor \bnfpn{p-list} \bnfts{,} \bnfpn{p-interval}
      } \\
   \bnfprod{p-interval}{
      \bnfpn{place} \bnfts{:} \bnfpn{len} \bnfts{:} \bnfpn{stride} \bnfor
      \bnfpn{place} \bnfts{:} \bnfpn{len} \bnfor
      \bnfpn{place} \bnfor
      \bnfts{!} \bnfpn{place}
      } \\
   \bnfprod{place}{
      \bnfts{\{} \bnfpn{res-list} \bnfts{\}}
      } \\
   \bnfprod{res-list}{
      \bnfpn{res-interval} \bnfor
      \bnfpn{res-list} \bnfts{,} \bnfpn{res-interval}
      } \\
   \bnfprod{res-interval}{
      \bnfpn{res} \bnfts{:} \bnfpn{num-places} \bnfts{:} \bnfpn{stride} \bnfor
      \bnfpn{res} \bnfts{:} \bnfpn{num-places} \bnfor
      \bnfpn{res} \bnfor
      \bnfts{!} \bnfpn{res}
   } \\
   \bnfprod{aname}{
      \bnfpn{word} \bnfts{(} \bnfpn{num-places} \bnfts{)} \bnfor
      \bnfpn{word}
   } \\
   \bnfprod{word}{
      \bnfts{sockets} \bnfor
      \bnfts{cores} \bnfor
      \bnfts{threads} \bnfor
      \bnfts{<implementation-defined abstract name>}
   } \\
   \bnfprod{res}{
      \bnftd{non-negative integer}
   } \\
   \bnfprod{num-places}{
      \bnftd{positive integer}
   } \\
   \bnfprod{stride}{
      \bnftd{integer}
   } \\
   \bnfprod{len}{
      \bnftd{positive integer}
   } \\
\end{bnf*}

\pagebreak

\begin{samepage}
Examples:
\begin{ompEnv}
setenv OMP_PLACES threads
setenv OMP_PLACES "threads(4)"
setenv OMP_PLACES "{0,1,2,3},{4,5,6,7},{8,9,10,11},{12,13,14,15}"
setenv OMP_PLACES "{0:4},{4:4},{8:4},{12:4}"
setenv OMP_PLACES "{0:4}:4:4"
\end{ompEnv}
\end{samepage}

where each of the last three definitions corresponds to the same 4 places including the
smallest units of execution exposed by the execution environment numbered, in turn, 0
to 3, 4 to 7, 8 to 11, and 12 to 15.

\crossreferences
\begin{itemize}
\item \plc{place-partition-var}, \specref{sec:Internal Control Variables}.

\item Controlling OpenMP thread affinity, \specref{subsec:Controlling OpenMP Thread Affinity}.

\item \code{omp_get_num_places} routine, see \specref{subsec:omp_get_num_places}.

\item \code{omp_get_place_num_procs} routine, see \specref{subsec:omp_get_place_num_procs}.

\item \code{omp_get_place_proc_ids} routine, see \specref{subsec:omp_get_place_proc_ids}.

\item \code{omp_get_place_num} routine, see \specref{subsec:omp_get_place_num}.

\item \code{omp_get_partition_num_places} routine, see \specref{subsec:omp_get_partition_num_places}.

\item \code{omp_get_partition_place_nums} routine, see \specref{subsec:omp_get_partition_place_nums}.
\end{itemize}










\section{\hcode{OMP_NESTED}}
\index{OMP_NESTED@{\code{OMP_NESTED}}}
\index{environment variables!OMP_NESTED@{\code{OMP_NESTED}}}
\label{sec:OMP_NESTED}
The deprecated \code{OMP_NESTED} environment variable controls nested parallelism by setting the
initial value of the \plc{nest-var} ICV. The value of this environment variable must be \code{true}
or \code{false}. If the environment variable is set to \code{true}, nested parallelism is enabled; if
set to \code{false}, nested parallelism is disabled. The behavior of the program is
implementation defined if the value of \code{OMP_NESTED} is neither \code{true} nor \code{false}.

Example:
\begin{ompEnv}
setenv OMP_NESTED false
\end{ompEnv}

\crossreferences
\begin{itemize}
\item \plc{nest-var} ICV, see \specref{sec:Internal Control Variables}.

\item \code{omp_set_nested} routine, see \specref{subsec:omp_set_nested}.

\item \code{omp_get_team_size} routine, see \specref{subsec:omp_get_team_size}.
\end{itemize}











\section{\hcode{OMP_STACKSIZE}}
\index{OMP_STACKSIZE@{\code{OMP_STACKSIZE}}}
\index{environment variables!OMP_STACKSIZE@{\code{OMP_STACKSIZE}}}
\label{sec:OMP_STACKSIZE}
The \code{OMP_STACKSIZE} environment variable controls the size of the stack for threads
created by the OpenMP implementation, by setting the value of the \plc{stacksize-var} ICV.
The environment variable does not control the size of the stack for an initial thread.

The value of this environment variable takes the form:

\plc{size} | \plc{size}\code{B} | \plc{size}\code{K} | \plc{size}\code{M} | \plc{size}\code{G}

where:

\begin{itemize}
\item \plc{size} is a positive integer that specifies the size of the stack for threads that are created
by the OpenMP implementation.

\item \code{B}, \code{K}, \code{M}, and \code{G} are letters that specify
whether the given size is in Bytes, Kilobytes
(1024 Bytes), Megabytes (1024 Kilobytes), or Gigabytes (1024 Megabytes),
respectively. If one of these letters is present, there may be white space between
\plc{size} and the letter.
\end{itemize}

If only \plc{size} is specified and none of \code{B}, \code{K}, \code{M}, or \code{G}
is specified, then \plc{size} is assumed to be in Kilobytes.

The behavior of the program is implementation defined if \code{OMP_STACKSIZE} does not
conform to the above format, or if the implementation cannot provide a stack with the
requested size.

Examples:
\begin{ompEnv}
setenv OMP_STACKSIZE 2000500B
setenv OMP_STACKSIZE "3000 k "
setenv OMP_STACKSIZE 10M
setenv OMP_STACKSIZE " 10 M "
setenv OMP_STACKSIZE "20 m "
setenv OMP_STACKSIZE " 1G"
setenv OMP_STACKSIZE 20000
\end{ompEnv}

\crossreferences
\begin{itemize}
\item \plc{stacksize-var} ICV, see \specref{sec:Internal Control Variables}.
\end{itemize}









\section{\hcode{OMP_WAIT_POLICY}}
\index{OMP_WAIT_POLICY@{\code{OMP_WAIT_POLICY}}}
\index{environment variables!OMP_WAIT_POLICY@{\code{OMP_WAIT_POLICY}}}
\label{sec:OMP_WAIT_POLICY}
The \code{OMP_WAIT_POLICY} environment variable provides a hint to an OpenMP
implementation about the desired behavior of waiting threads by setting the
\plc{wait-policy-var} ICV. A compliant OpenMP implementation may or may not abide by the setting of
the environment variable.

The value of this environment variable takes the form:

{\code{ACTIVE }|\code{ PASSIVE}}

The \code{ACTIVE} value specifies that waiting threads should mostly be active, consuming
processor cycles, while waiting. An OpenMP implementation may, for example, make
waiting threads spin.

The \code{PASSIVE} value specifies that waiting threads should mostly be passive, not
consuming processor cycles, while waiting. For example, an OpenMP implementation
may make waiting threads yield the processor to other threads or go to sleep.

The details of the \code{ACTIVE} and \code{PASSIVE} behaviors are implementation defined.

Examples:
\begin{ompEnv}
setenv OMP_WAIT_POLICY ACTIVE
setenv OMP_WAIT_POLICY active
setenv OMP_WAIT_POLICY PASSIVE
setenv OMP_WAIT_POLICY passive
\end{ompEnv}

\crossreferences
\begin{itemize}
\item \plc{wait-policy-var} ICV, see \specref{sec:Internal Control Variables}.
\end{itemize}










\section{\hcode{OMP_MAX_ACTIVE_LEVELS}}
\index{OMP_MAX_ACTIVE_LEVELS@{\code{OMP_MAX_ACTIVE_LEVELS}}}
\index{environment variables!OMP_MAX_ACTIVE_LEVELS@{\code{OMP_MAX_ACTIVE_LEVELS}}}
\label{sec:OMP_MAX_ACTIVE_LEVELS}
The \code{OMP_MAX_ACTIVE_LEVELS} environment variable controls the maximum number
of nested active \code{parallel} regions by setting the initial value of the \plc{max-active-levels-var} ICV.

The value of this environment variable must be a non-negative integer. The behavior of
the program is implementation defined if the requested value of
\code{OMP_MAX_ACTIVE_LEVELS} is greater than the maximum number of nested active
parallel levels an implementation can support, or if the value is not a non-negative
integer.

\crossreferences
\begin{itemize}
\item \plc{max-active-levels-var} ICV, see \specref{sec:Internal Control Variables}.

\item \code{omp_set_max_active_levels} routine, see \specref{subsec:omp_set_max_active_levels}.

\item \code{omp_get_max_active_levels} routine, see \specref{subsec:omp_get_max_active_levels}.
\end{itemize}










\section{\hcode{OMP_THREAD_LIMIT}}
\index{OMP_THREAD_LIMIT@{\code{OMP_THREAD_LIMIT}}}
\index{environment variables!OMP_THREAD_LIMIT@{\code{OMP_THREAD_LIMIT}}}
\label{sec:OMP_THREAD_LIMIT}
The \code{OMP_THREAD_LIMIT} environment variable sets the maximum number of OpenMP threads to use in a contention group by setting the \plc{thread-limit-var} ICV.

The value of this environment variable must be a positive integer. The behavior of the
program is implementation defined if the requested value of \code{OMP_THREAD_LIMIT} is
greater than the number of threads an implementation can support, or if the value is not
a positive integer.

\crossreferences
\begin{itemize}
\item \plc{thread-limit-var} ICV, see \specref{sec:Internal Control Variables}.

\item \code{omp_get_thread_limit} routine, see \specref{subsec:omp_get_thread_limit}.
\end{itemize}









\section{\hcode{OMP_CANCELLATION}}
\index{OMP_CANCELLATION@{\code{OMP_CANCELLATION}}}
\index{environment variables!OMP_CANCELLATION@{\code{OMP_CANCELLATION}}}
\label{sec:OMP_CANCELLATION}
The \code{OMP_CANCELLATION} environment variable sets the initial value of the \plc{cancel-var}
ICV.

The value of this environment variable must be \code{true} or \code{false}. If set to \code{true}, the
effects of the \code{cancel} construct and of cancellation points are enabled and cancellation
is activated. If set to \code{false}, cancellation is disabled and the \code{cancel} construct and
cancellation points are effectively ignored.

\crossreferences
\begin{itemize}
\item \plc{cancel-var}, see \specref{subsec:ICV Descriptions}.

\item \code{cancel} construct, see \specref{subsec:cancel Construct}.

\item \code{cancellation point} construct, see \specref{subsec:cancellation point Construct}.

\item \code{omp_get_cancellation} routine, see \specref{subsec:omp_get_cancellation}.
\end{itemize}









\section{\hcode{OMP_DISPLAY_ENV}}
\index{OMP_DISPLAY_ENV@{\code{OMP_DISPLAY_ENV}}}
\index{environment variables!OMP_DISPLAY_ENV@{\code{OMP_DISPLAY_ENV}}}
\index{_OPENMP@{\code{_OPENMP} macro}}
\label{sec:OMP_DISPLAY_ENV}
The \code{OMP_DISPLAY_ENV} environment variable instructs the runtime to display the
OpenMP version number and the value of the ICVs associated with the environment
variables described in Chapter \ref{chap:Environment Variables},
as \plc{name} = \plc{value} pairs. The runtime displays this
information once, after processing the environment variables and before any user calls
to change the ICV values by runtime routines defined in Chapter \ref{chap:Runtime Library Routines}.

The value of the \code{OMP_DISPLAY_ENV} environment variable may be set to one of these
values:

{\code{TRUE }|\code{ FALSE }|\code{ VERBOSE}}

The \code{TRUE} value instructs the runtime to display the OpenMP version number defined by
the \code{_OPENMP} version macro (or the \code{openmp_version} Fortran parameter) value and
the initial ICV values for the environment variables listed in
Chapter \ref{chap:Environment Variables}. The \code{VERBOSE}
value indicates that the runtime may also display the values
of runtime variables that may be modified by vendor-specific
environment variables. The runtime does not display any information
when the \code{OMP_DISPLAY_ENV} environment variable is
\code{FALSE} or undefined. For all values of the environment
variable other than \code{TRUE}, \code{FALSE}, and \code{VERBOSE},
the displayed information is unspecified.

The display begins with \texttt{"OPENMP DISPLAY ENVIRONMENT BEGIN"}, followed by
the \code{_OPENMP} version macro (or the \code{openmp_version} Fortran parameter) value and
ICV values, in the format \plc{NAME} '=' \plc{VALUE}. \plc{NAME} corresponds to the macro or
environment variable name, optionally prepended by a bracketed \plc{device-type}. \plc{VALUE}
corresponds to the value of the macro or ICV associated with this environment variable.
Values should be enclosed in single quotes. The display is terminated with
\texttt{"OPENMP DISPLAY ENVIRONMENT END"}.

Example:
\begin{ompEnv}
% setenv OMP_DISPLAY_ENV TRUE
\end{ompEnv}

The above example causes an OpenMP implementation to generate output of the
following form:

\begin{ompEnv}
OPENMP DISPLAY ENVIRONMENT BEGIN
  _OPENMP='201811'
  [host] OMP_SCHEDULE='GUIDED,4'
  [host] OMP_NUM_THREADS='4,3,2'
  [device] OMP_NUM_THREADS='2'
  [host,device] OMP_DYNAMIC='TRUE'
  [host] OMP_PLACES='{0:4},{4:4},{8:4},{12:4}'
  ...
OPENMP DISPLAY ENVIRONMENT END
\end{ompEnv}


\section{\hcode{OMP_DISPLAY_AFFINITY}}
\index{OMP_DISPLAY_AFFINITY@{\code{OMP_DISPLAY_AFFINITY}}}
\index{environment variables!OMP_DISPLAY_AFFINITY@{\code{OMP_DISPLAY_AFFINITY}}}
\index{_OPENMP@{\code{_OPENMP} macro}}
\label{sec:OMP_DISPLAY_AFFINITY}
The \code{OMP_DISPLAY_AFFINITY} environment variable instructs the runtime to
display formatted affinity information for all OpenMP threads in the parallel
region upon entering the first parallel region and when there is any change in
the information accessible by the format specifiers listed in table
\ref{tab:Available Field Types for Formatting OpenMP Thread Affinity Information}.
If there is a change of affinity of any thread in a parallel region, thread
affinity information for all threads in that region will be displayed.
There is no specific order in displaying thread affinity information for all
threads in the same parallel region.

The value of the \code{OMP_DISPLAY_AFFINITY} environment variable may be set to one of these
values:

{\code{TRUE }|\code{ FALSE}}

%The default is set to \code{FALSE}.

The \code{TRUE} value instructs the runtime to display the OpenMP thread affinity information, and uses the
format setting defined in the \plc{affinity-format-var} ICV.

The runtime does not display the OpenMP thread affinity information when the value of the \code{OMP_DISPLAY_AFFINITY}
environment variable is \code{FALSE} or undefined. For all values of the environment
variable other than \code{TRUE} or \code{FALSE}, the display action is implementation defined.

Example:
\begin{ompEnv}
setenv OMP_DISPLAY_AFFINITY TRUE
\end{ompEnv}

The above example causes an OpenMP implementation to display OpenMP thread affinity information during execution of
the program, in a format given by the \plc{affinity-format-var} ICV.  The following is a sample output:
\begin{ompSyntax}
thread_level=   1,   thread_id=   0,   thread_affinity=    0,1
thread_level=   1,   thread_id=   1,   thread_affinity=    2,3
\end{ompSyntax}

\crossreferences
\begin{itemize}

\item Controlling OpenMP thread affinity, see
\specref{subsec:Controlling OpenMP Thread Affinity}.
\item \code{omp_set_affinity_format} routine, see \specref{subsec:omp_set_affinity_format}.
\item \code{omp_get_affinity_format} routine, see \specref{subsec:omp_get_affinity_format}.
\item \code{omp_display_affinity} routine, see \specref{subsec:omp_display_affinity}.
\item \code{omp_capture_affinity} routine, see \specref{subsec:omp_capture_affinity}.
\item \code{OMP_AFFINITY_FORMAT} environment variable, see
\specref{sec:OMP_AFFINITY_FORMAT}.
\end{itemize}


\section{\hcode{OMP_AFFINITY_FORMAT}}
\index{OMP_AFFINITY_FORMAT@{\code{OMP_AFFINITY_FORMAT}}}
\index{environment variables!OMP_AFFINITY_FORMAT@{\code{OMP_AFFINITY_FORMAT}}}
\index{_OPENMP@{\code{_OPENMP} macro}}
\label{sec:OMP_AFFINITY_FORMAT}

The \code{OMP_AFFINITY_FORMAT} environment variable sets the initial value of the
\plc{affinity-format-var} ICV which defines the format when displaying OpenMP
thread affinity information.

%The default value for \code{OMP_AFFINITY_FORMAT} is implementation defined.

The value of this environment variable is a character string that may contain as
substrings one or more field specifiers, in addition to other characters.
The format of each field specifier is

\begin{ompSyntax}
%\plc{[[[}0\plc{]}.\plc{] size ] type}
\end{ompSyntax}

where an individual field specifier must contain the percent symbol ({\pcode{\%}}) and a type.
The type can be a single character short name or its corresponding long name delimited with curly braces,
 such as {\pcode{\%n}} or {\pcode{\%\{thread\_num\}}}.
%(The "0", "." and \plc{size} are optional.)
A literal percent is specified as {\pcode{\%\%}}.  Field specifiers can be provided in any order.

The \code{0} modifier indicates whether or not to add leading zeros to the output,
following any indication of sign or base.
The \code{.} modifier indicates the output should be right justified when \plc{size} is specified.
By default, output is left justified.
The minimum field length is \plc{size}, which is decimal digit string
with non-zero first digit.
If no \plc{size} is specified, the actual length needed to print the field will be used.
If the \code{0} modifier is used with \plc{type} of \code{a}, {\pcode{\{thread\_affinity\}}},
\code{h}, {\pcode{\{host\}}}, or a type that is not printed as a number, the
result is unspecified.

Any other characters in the format string that are not part of a field specifier will be included literally
in the output.

Available field types are:

% Table
\nolinenumbers
\renewcommand{\arraystretch}{1.5}
\tablefirsthead{%
\hline
\textsf{\textbf{Short Name}} & \textsf{\textbf{Long Name}} & \textsf{\textbf{Meaning}}\\
\hline \\[-3ex]
}
\tablehead{%
\multicolumn{3}{l}{\small\slshape table continued from previous page}\\
\hline
\textsf{\textbf{Short Name}} & \textsf{textbf{Long Name}} & \textsf{\textbf{Meaning}}\\
\hline \\[-3ex]
}
\tabletail{%
\hline\\[-4ex]
\multicolumn{3}{l}{\small\slshape table continued on next page}\\
}
\tablelasttail{\hline}
\tablecaption{Available Field Types for Formatting OpenMP Thread Affinity Information \label{tab:Available Field Types for Formatting OpenMP Thread Affinity Information}}
\begin{supertabular}{ p{0.06\textwidth} p{0.24\textwidth} p{0.6\textwidth}}
{\scode{L}} & {\scode{thread_level}} & The value returned by {\scode{omp_get_level()}}. \\
{\scode{n}} & {\scode{thread_num}} &  The value returned by {\scode{omp_get_thread_num()}}. \\
{\scode{h}} & {\scode{host}} & The name for the host machine on which the OpenMP program is running. \\
{\scode{P}} & {\scode{process_id}} & The process identifier used by the implementation. \\
{\scode{T}} & {\scode{thread_identifier}} & The thread identifier for a native thread defined by the implementation. \\
{\scode{N}} & {\scode{num_threads}} & The value returned by {\scode{omp_get_num_threads()}}. \\
{\scode{A}} & {\scode{ancestor_tnum}} & The value returned by {\scode{omp_get_ancestor_thread_num(}\splc{level}\scode{)}}, where {\splc{level}} is
{\scode{omp_get_level()}} minus 1. \\
{\scode{a}} & {\scode{thread_affinity}} & The list of numerical identifiers, in the format of a comma-separated list of integers or integer ranges, representing processors on which a thread may execute, subject to OpenMP thread affinity control and/or other external affinity mechanisms. \\

\end{supertabular}

\linenumbers

%Often a descriptive string is used to prefix a field, as in the format  
%"thread\_level=\%.5L",
%and a comma or space is often used to separate the output of each field, as in the format
%"thread\_num=\%0.4n affinity=\%a".
% A literal percent is specified as "\%\%".

Implementations may define additional field types.  If an implementation does not have information
for a field type, "undefined" is printed for this field when displaying the OpenMP thread 
affinity information.

%As an example, some compilers may wish to define field names corresponding to MPI rank information.


Example:
\begin{ompEnv}
setenv OMP_AFFINITY_FORMAT
       "Thread Affinity: %0.3L %.8n %.15{thread_affinity} %.12h"
\end{ompEnv}

The above example causes an OpenMP implementation to display OpenMP thread affinity information in the following form:
\begin{ompSyntax}
Thread Affinity: 001        0      0-1,16-17      nid003
Thread Affinity: 001        1      2-3,18-19      nid003
\end{ompSyntax}

\crossreferences
\begin{itemize}
\item Controlling OpenMP thread affinity, see
\specref{subsec:Controlling OpenMP Thread Affinity}.
\item \code{omp_set_affinity_format} routine, see \specref{subsec:omp_set_affinity_format}.
\item \code{omp_get_affinity_format} routine, see \specref{subsec:omp_get_affinity_format}.
\item \code{omp_display_affinity} routine, see \specref{subsec:omp_display_affinity}.
\item \code{omp_capture_affinity} routine, see \specref{subsec:omp_capture_affinity}.
\item \code{OMP_DISPLAY_AFFINITY} environment variable, see
\specref{sec:OMP_DISPLAY_AFFINITY}.
\end{itemize}


\section{\hcode{OMP_DEFAULT_DEVICE}}
\index{OMP_DEFAULT_DEVICE@{\code{OMP_DEFAULT_DEVICE}}}
\index{environment variables!OMP_DEFAULT_DEVICE@{\code{OMP_DEFAULT_DEVICE}}}
\label{sec:OMP_DEFAULT_DEVICE}
The \code{OMP_DEFAULT_DEVICE} environment variable sets the device number to use in
device constructs by setting the initial value of the \plc{default-device-var} ICV.

The value of this environment variable must be a non-negative integer value.

\crossreferences
\begin{itemize}
\item \plc{default-device-var} ICV, see \specref{sec:Internal Control Variables}.

\item device directives, \specref{sec:Device Directives}.
\end{itemize}


\section{\hcode{OMP_MAX_TASK_PRIORITY}}
\index{OMP_MAX_TASK_PRIORITY_DEVICE@{\code{OMP_MAX_TASK_PRIORITY}}}
\index{environment variables!OMP_MAX_TASK_PRIORITY@{\code{OMP_MAX_TASK_PRIORITY}}}
\label{sec:OMP_MAX_TASK_PRIORITY}

The \code{OMP_MAX_TASK_PRIORITY} environment variable controls the use of task
priorities by setting the initial value of the \plc{max-task-priority-var} ICV. The
value of this environment variable must be a non-negative integer.

Example:
\begin{ompEnv}
% setenv OMP_MAX_TASK_PRIORITY 20
\end{ompEnv}

\crossreferences
\begin{itemize}
\item \plc{max-task-priority-var} ICV, see \specref{sec:Internal Control Variables}.
\item Tasking Constructs, see \specref{sec:Tasking Constructs}.
\item \code{omp_get_max_task_priority} routine, see \specref{subsec:omp_get_max_task_priority}.
\end{itemize}




\section{\hcode{OMP_TARGET_OFFLOAD}}
\index{OMP_TARGET_OFFLOAD@{\code{OMP_TARGET_OFFLOAD}}}
\index{environment variables!OMP_TARGET_OFFLOAD@{\code{OMP_TARGET_OFFLOAD}}}
\label{sec:OMP_TARGET_OFFLOAD}
%
The \code{OMP_TARGET_OFFLOAD} environment variable sets the initial value of the \plc{target-offload-var} ICV.
The value of the \code{OMP_TARGET_OFFLOAD} environment variable may be set to one of these
values:

{\code{MANDATORY }|\code{ DISABLED }|\code{ DEFAULT}}

The \code{MANDATORY} value specifies that a device construct or a device memory routine must execute on a target device. If the device construct cannot execute on its target device, or if a device memory routine fails to execute, a warning is issued and the program execution aborts. Device constructs are exempt from this behavior when an if-clause is present and the if-clause expression evaluates to false.

The support of \code{DISABLED}  is implementation defined. If an implementation supports it, the behavior should be that a device construct must execute on the host.  The behavior with this environment value is equivalent to an if clause present on all device constructs, where each of these if clause expressions evaluate to false. Device memory routines behave as if all device number parameters are set to the value returned by \code{omp_get_initial_device()}. The \code{omp_get_initial_device()} routine returns that no target device is available

The \code{DEFAULT} value specifies that when one or more target devices are available, the runtime behaves as if this environment variable is set to \code{MANDATORY}; otherwise, the runtime behaves as if this environment variable is set to \code{DISABLED}.

Example:
\begin{ompEnv}
% setenv OMP_TARGET_OFFLOAD MANDATORY
\end{ompEnv}

\crossreferences
\begin{itemize}
\item \plc{target-offload-icv} ICV, see \specref{sec:Internal Control Variables}.
\item device directives, \specref{sec:Device Directives}.
\end{itemize}




\section{\hcode{OMP_TOOL}}
\index{OMP_TOOL@{\code{OMP_TOOL}}}
\index{environment variables!OMP_TOOL@{\code{OMP_TOOL}}}
\label{sec:OMP_TOOL}

The \code{OMP_TOOL} environment variable sets the \plc{tool-var} ICV which controls whether an OpenMP runtime will try to register a
first party tool.
The value of this environment variable must be \code{enabled} or \code{disabled}.
If \code{OMP_TOOL} is set to any value other than \code{enabled} or \code{disabled}, the behavior is unspecified.
If \code{OMP_TOOL} is not defined, the default value for \plc{tool-var} is \code{enabled}.

Example:
\begin{ompEnv}
% setenv OMP_TOOL enabled
\end{ompEnv}

\crossreferences
\begin{itemize}
\item \plc{tool-var} ICV, see \specref{sec:Internal Control Variables}.
\item Tool Interface, see \specref{chap:ToolsSupport}.
\end{itemize}




\section{\hcode{OMP_TOOL_LIBRARIES}}
\index{OMP_TOOL_LIBRARIES@{\code{OMP_TOOL_LIBRARIES}}}
\index{environment variables!OMP_TOOL_LIBRARIES@{\code{OMP_TOOL_LIBRARIES}}}
\label{sec:OMP_TOOL_LIBRARIES}

The \code{OMP_TOOL_LIBRARIES} environment variable sets the
\plc{tool-libraries-var} ICV to a list of tool libraries that will
be considered for use on a device where an OpenMP implementation
is being initialized.  The value of this environment variable must
be a colon-separated list of dynamically-linked libraries, each
specified by an absolute path.

If the \plc{tool-var} ICV is not enabled,
the value of \plc{tool-libraries-var} will be ignored.
Otherwise, if \code{ompt_start_tool}, a global function symbol for a tool initializer,
isn't visible in the address space on a device where OpenMP is being
initialized or if \code{ompt_start_tool} returns \code{NULL}, an OpenMP implementation
will consider libraries in the \plc{tool-libraries-var} list
in a left to right order.  The OpenMP implementation will search the list for
a library that meets two criteria: it can be dynamically
loaded on the current device and it defines the symbol \code{ompt_start_tool}.
If an OpenMP implementation finds a suitable library,
no further libraries in the list will be considered.

\crossreferences
\begin{itemize}
\item \plc{tool-libraries-var} ICV, see \specref{sec:Internal Control Variables}.
\item Tool Interface, see \specref{chap:ToolsSupport}.
\item \code{ompt_start_tool} routine, see \specref{sec:ompt_start_tool}.
\end{itemize}

\section{\hcode{OMP_DEBUG}}
\index{OMP_DEBUG@{\code{OMP_DEBUG}}}
\index{environment variables!OMP_DEBUG@{\code{OMP_DEBUG}}}
\label{sec:OMP_DEBUG}

The \code{OMP_DEBUG} environment variable sets the
\plc{debug-var} ICV which controls whether an OpenMP runtime
will collect information that an OMPD library may need to support
a tool.
The value of this environment variable must be \code{enabled}
or \code{disabled}.
If \code{OMP_DEBUG} is set to any value other than \code{enabled}
or \code{disabled}, the behavior is implementation defined.

Example:
\begin{ompEnv}
% setenv OMP_DEBUG enabled
\end{ompEnv}

\crossreferences
\begin{itemize}
\item \plc{debug-var} ICV,
see \specref{sec:Internal Control Variables}.
\item Tool Interface, see \specref{chap:ToolsSupport}.
\item Enabling the Runtime for OMPD, see \specref{subsubsec:enabling-ompd}.
\end{itemize}


\section{\hcode{OMP_ALLOCATOR}}
\index{OMP_ALLOCATOR@{\code{OMP_ALLOCATOR}}}
\index{environment variables!OMP_ALLOCATOR@{\code{OMP_ALLOCATOR}}}
\label{sec:OMP_ALLOCATOR}

\code{OMP_ALLOCATOR} sets the \plc{def-allocator-var} ICV that specifies the default
allocator for allocation calls, directives and clauses that do not specify an allocator.
The value of this environment variable is a predefined allocator from \tabref{tab:Predefined Allocators}. The value of this environment variable is not case sensitive.

\crossreferences
\begin{itemize}
\item \plc{def-allocator-var} ICV, see \specref{sec:Internal Control Variables}.

\item Memory allocators, see \specref{subsec:Memory Allocators}.

\item \code{omp_set_default_allocator} routine, see \specref{subsec:omp_set_default_allocator}.

\item \code{omp_get_default_allocator} routine, see \specref{subsec:omp_get_default_allocator}.
\end{itemize}


% This is the end of ch5-environmentVariables.tex
