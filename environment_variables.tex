% This is environment_variables.tex (Chapter 5) of the OpenMP specification.
% This is an included file. See the master file for more information.
%
% When editing this file:
%
%    1. To change formatting, appearance, or style, please edit openmp.sty.
%
%    2. Custom commands and macros are defined in openmp.sty.
%
%    3. Be kind to other editors -- keep a consistent style by copying-and-pasting to
%       create new content.
%
%    4. We use semantic markup, e.g. (see openmp.sty for a full list):
%         \code{}     % for bold monospace keywords, code, operators, etc.
%         \plc{}      % for italic placeholder names, grammar, etc.
%
%    5. There are environments that provide special formatting, e.g. language bars.
%       Please use them whereever appropriate.  Examples are:
%
%         \begin{fortranspecific}
%         This is text that appears enclosed in blue language bars for Fortran.
%         \end{fortranspecific}
%
%         \begin{note}
%         This is a note.  The "Note -- " header appears automatically.
%         \end{note}
%
%    6. Other recommendations:
%         Use the convenience macros defined in openmp.sty for the minor headers
%         such as Comments, Syntax, etc.
%
%         To keep items together on the same page, prefer the use of 
%         \begin{samepage}.... Avoid \parbox for text blocks as it interrupts line numbering.
%         When possible, avoid \filbreak, \pagebreak, \newpage, \clearpage unless that's
%         what you mean. Use \needspace{} cautiously for troublesome paragraphs.
%
%         Avoid absolute lengths and measures in this file; use relative units when possible.
%         Vertical space can be relative to \baselineskip or ex units. Horizontal space
%         can be relative to \linewidth or em units.
%
%         Prefer \emph{} to italicize terminology, e.g.:
%             This is a \emph{definition}, not a placeholder.
%             This is a \plc{var-name}.
%

\chapter{Environment Variables}
\index{environment variables}
\index{variables, environment}
\label{chap:Environment Variables}
This chapter describes the OpenMP environment variables that specify the settings of
the ICVs that affect the execution of OpenMP programs (see \specref{sec:Internal Control Variables}).
The names of the environment variables must be upper case. The values assigned to the
environment variables are case insensitive and may have leading and trailing white
space. Modifications to the environment variables after the program has started, even if
modified by the program itself, are ignored by the OpenMP implementation. However,
the settings of some of the ICVs can be modified during the execution of the OpenMP
program by the use of the appropriate directive clauses or OpenMP API routines.

The following examples demonstrate how the OpenMP environment variables can
be set in different environments:

\begin{itemize}
\item csh-like shells:
\end{itemize}

\begin{boxedcode}
setenv OMP\_SCHEDULE "dynamic"
\end{boxedcode}

\begin{itemize}
\item bash-like shells:
\end{itemize}

\begin{boxedcode}
export OMP\_SCHEDULE="dynamic"
\end{boxedcode}

\begin{itemize}
\item Windows Command Line:
\end{itemize}

\begin{boxedcode}
set OMP\_SCHEDULE=dynamic
\end{boxedcode}


\section{\code{OMP\_SCHEDULE}}
\index{OMP\_SCHEDULE@{\code{OMP\_SCHEDULE}}}
\index{environment variables!OMP\_SCHEDULE@{\code{OMP\_SCHEDULE}}}
\label{sec:OMP_SCHEDULE}
The \code{OMP\_SCHEDULE} environment variable controls the schedule type and chunk size 
of all loop directives that have the schedule type \code{runtime}, by setting the value of the 
\plc{run-sched-var} ICV.

The value of this environment variable takes the form:

\plc{type}[,\plc{ chunk}]

where

\begin{itemize}
\item \plc{type} is one of \code{static}, \code{dynamic}, \code{guided}, or \code{auto}

\item \plc{chunk} is an optional positive integer that specifies the chunk size
\end{itemize}

If \plc{chunk} is present, there may be white space on either side of the ``\code{,}''. See 
\specref{subsec:Loop Construct} for a detailed description of the schedule types.

The behavior of the program is implementation defined if the value of \code{OMP\_SCHEDULE} 
does not conform to the above format.

Implementation specific schedules cannot be specified in \code{OMP\_SCHEDULE}. They can 
only be specified by calling \code{omp\_set\_schedule}, described in \specref{subsec:omp_set_schedule}. 

Examples:

\begin{boxedcode}
setenv OMP\_SCHEDULE "guided,4" 
setenv OMP\_SCHEDULE "dynamic"
\end{boxedcode}

\crossreferences
\begin{itemize}
\item \plc{run-sched-var} ICV, see \specref{sec:Internal Control Variables}.

\item Loop construct, see \specref{subsec:Loop Construct}.

\item Parallel loop construct, see \specref{subsec:Parallel Loop Construct}.

\item \code{omp\_set\_schedule} routine, see \specref{subsec:omp_set_schedule}.

\item \code{omp\_get\_schedule} routine, see \specref{subsec:omp_get_schedule}.
\end{itemize}









\section{\code{OMP\_NUM\_THREADS}}
\index{OMP\_NUM\_THREADS@{\code{OMP\_NUM\_THREADS}}}
\index{environment variables!OMP\_NUM\_THREADS@{\code{OMP\_NUM\_THREADS}}}
\label{sec:OMP_NUM_THREADS}
The \code{OMP\_NUM\_THREADS} environment variable sets the number of threads to use for 
\code{parallel} regions by setting the initial value of the \plc{nthreads-var} ICV. See 
\specref{sec:Internal Control Variables} for a comprehensive set of rules about the interaction between the 
\code{OMP\_NUM\_THREADS} environment variable, the \code{num\_threads} clause, the 
\code{omp\_set\_num\_threads} library routine and dynamic adjustment of threads, and 
\specref{subsec:Determining the Number of Threads for a parallel Region} 
for a complete algorithm that describes how the number of 
threads for a \code{parallel} region is determined.

The value of this environment variable must be a list of positive integer values. The 
values of the list set the number of threads to use for \code{parallel} regions at the 
corresponding nested levels.

The behavior of the program is implementation defined if any value of the list specified 
in the \code{OMP\_NUM\_THREADS} environment variable leads to a number of threads which is 
greater than an implementation can support, or if any value is not a positive integer.

Example:
\begin{boxedcode}
setenv OMP\_NUM\_THREADS 4,3,2
\end{boxedcode}

\crossreferences
\begin{itemize}
\item \plc{nthreads-var} ICV, see \specref{sec:Internal Control Variables}.

\item \code{num\_threads} clause, \specref{sec:parallel Construct}.

\item \code{omp\_set\_num\_threads} routine, see \specref{subsec:omp_set_num_threads}.

\item \code{omp\_get\_num\_threads} routine, see \specref{subsec:omp_get_num_threads}.

\item \code{omp\_get\_max\_threads} routine, see \specref{subsec:omp_get_max_threads}.

\item \code{omp\_get\_team\_size} routine, see \specref{subsec:omp_get_team_size}.
\end{itemize}







\section{\code{OMP\_DYNAMIC}}
\index{OMP\_DYNAMIC@{\code{OMP\_DYNAMIC}}}
\index{environment variables!OMP\_DYNAMIC@{\code{OMP\_DYNAMIC}}}
\label{sec:OMP_DYNAMIC}
The \code{OMP\_DYNAMIC} environment variable controls dynamic adjustment of the number 
of threads to use for executing \code{parallel} regions by setting the initial value of the 
\plc{dyn-var} ICV. The value of this environment variable must be \code{true} or \code{false}. If the 
environment variable is set to \code{true}, the OpenMP implementation may adjust the 
number of threads to use for executing \code{parallel} regions in order to optimize the use 
of system resources. If the environment variable is set to \code{false}, the dynamic 
adjustment of the number of threads is disabled. The behavior of the program is 
implementation defined if the value of \code{OMP\_DYNAMIC} is neither \code{true} nor \code{false}.

Example:
\begin{boxedcode}
setenv OMP\_DYNAMIC true
\end{boxedcode}

\crossreferences
\begin{itemize}
\item \plc{dyn-var} ICV, see \specref{sec:Internal Control Variables}.

\item \code{omp\_set\_dynamic} routine, see \specref{subsec:omp_set_dynamic}.

\item \code{omp\_get\_dynamic} routine, see \specref{subsec:omp_get_dynamic}.
\end{itemize}









\section{\code{OMP\_PROC\_BIND}}
\index{OMP\_PROC\_BIND@{\code{OMP\_PROC\_BIND}}}
\index{environment variables!OMP\_PROC\_BIND@{\code{OMP\_PROC\_BIND}}}
\label{sec:OMP_PROC_BIND}
The \code{OMP\_PROC\_BIND} environment variable sets the initial value of the \plc{bind-var} ICV. 
The value of this environment variable is either \code{true}, \code{false}, or a comma separated 
list of \code{master}, \code{close}, or \code{spread}. The values of the list set the thread affinity policy 
to be used for parallel regions at the corresponding nested level.

If the environment variable is set to \code{false}, the execution environment may move 
OpenMP threads between OpenMP places, thread affinity is disabled, and \code{proc\_bind} 
clauses on \code{parallel} constructs are ignored.

Otherwise, the execution environment should not move OpenMP threads between 
OpenMP places, thread affinity is enabled, and the initial thread is bound to the first 
place in the OpenMP place list prior to the first active parallel region.

The behavior of the program is implementation defined if the value in the 
\code{OMP\_PROC\_BIND} environment variable is not \code{true}, \code{false}, or a comma separated 
list of \code{master}, \code{close}, or \code{spread}. The behavior is also implementation defined if an 
initial thread cannot be bound to the first place in the OpenMP place list.

\pagebreak

Examples:
\begin{boxedcode}
setenv OMP\_PROC\_BIND false
setenv OMP\_PROC\_BIND "spread, spread, close"
\end{boxedcode}


\crossreferences
\begin{itemize}
\item \plc{bind-var} ICV, see \specref{sec:Internal Control Variables}.

\item \code{proc\_bind} clause, see \specref{subsec:Controlling OpenMP Thread Affinity}.

\item \code{omp\_get\_proc\_bind} routine, see \specref{subsec:omp_get_proc_bind}.
\end{itemize}









\section{\code{OMP\_PLACES}}
\index{OMP\_PLACES@{\code{OMP\_PLACES}}}
\index{environment variables!OMP\_PLACES@{\code{OMP\_PLACES}}}
\label{sec:OMP_PLACES}
A list of places can be specified in the \code{OMP\_PLACES} environment variable. The 
\plc{place-partition-var} ICV obtains its initial value from the \code{OMP\_PLACES} value, and makes the 
list available to the execution environment. The value of \code{OMP\_PLACES} can be one of 
two types of values: either an abstract name describing a set of places or an explicit list 
of places described by non-negative numbers.

The \code{OMP\_PLACES} environment variable can be defined using an explicit ordered list of 
comma-separated places. A place is defined by an unordered set of comma-separated 
non-negative numbers enclosed by braces. The meaning of the numbers and how the 
numbering is done are implementation defined. Generally, the numbers represent the 
smallest unit of execution exposed by the execution environment, typically a hardware 
thread.

Intervals may also be used to define places. Intervals can be specified using the 
<\plc{lower-bound}> : <\plc{length}> : <\plc{stride}> notation to represent the following list of numbers: 
``<\plc{lower-bound}>, <\plc{lower-bound}> + <\plc{stride}>, ..., <\plc{lower-bound}> + (<\plc{length}>-
1)*<\plc{stride}>.'' When <\plc{stride}> is omitted, a unit stride is assumed. Intervals can specify 
numbers within a place as well as sequences of places.

An exclusion operator ``\code{!}'' can also be used to exclude the number or place immediately 
following the operator.

Alternatively, the abstract names listed in
Table~\ref{tab:Defined Abstract Names for OMP PLACES} should be understood
by the execution and runtime environment. The precise definitions of the
abstract names are implementation defined. An implementation may also add
abstract names as appropriate for the target platform.

The abstract name may be appended by a positive number in parentheses to denote the 
length of the place list to be created, that is \plc{abstract\_name(num-places)}. When 
requesting fewer places than available on the system, the determination of which 
resources of type \plc{abstract\_name} are to be included in the place list is implementation 
defined. When requesting more resources than available, the length of the place list is 
implementation defined.

% Table

\medskip
\nolinenumbers
\renewcommand{\arraystretch}{1.5}
\tablefirsthead{%
\hline
\textsf{\textbf{Abstract Name}} & \textsf{\textbf{Meaning}}\\
\hline
}
\tablehead{%
\multicolumn{2}{l}{\small\slshape table continued from previous page}\\
\hline\\
\textsf{\textbf{Abstract Name}} & \textsf{\textbf{Meaning}}\\
\hline
}
\tabletail{%
\hline\\
\multicolumn{2}{l}{\small\slshape table continued on next page}\\
}
\tablelasttail{\hline}
\tablecaption{Defined Abstract Names for \code{OMP\_PLACES}\label{tab:Defined Abstract Names for OMP PLACES}}
\begin{supertabular}{p{1.5in} p{3.5in}}
\code{threads} & Each place corresponds to a single hardware thread on the target machine.\\
\code{cores} & Each place corresponds to a single core (having one or more hardware 
threads) on the target machine.\\
\code{sockets} & Each place corresponds to a single socket (consisting of one or more cores) 
on the target machine.\\
\end{supertabular}

\linenumbers

The behavior of the program is implementation defined when the execution environment 
cannot map a numerical value (either explicitly defined or implicitly derived from an 
interval) within the \code{OMP\_PLACES} list to a processor on the target platform, or if it maps 
to an unavailable processor. The behavior is also implementation defined when the 
\code{OMP\_PLACES} environment variable is defined using an abstract name.

The following grammar describes the values accepted for the \code{OMP\_PLACES} environment
variable.

\begin{bnf*}
   \bnfprod{list}{
      \bnfpn{p-list} \bnfor
      \bnfpn{aname}
      } \\
   \bnfprod{p-list}{
      \bnfpn{p-interval} \bnfor \bnfpn{p-list} \bnfts{,} \bnfpn{p-interval}
      } \\
   \bnfprod{p-interval}{
      \bnfpn{place} \bnfts{:} \bnfpn{len} \bnfts{:} \bnfpn{stride} \bnfor
      \bnfpn{place} \bnfts{:} \bnfpn{len} \bnfor
      \bnfpn{place} \bnfor
      \bnfts{!} \bnfpn{place}
      } \\
   \bnfprod{place}{
      \bnfts{\{} \bnfpn{res-list} \bnfts{\}}
      } \\
   \bnfprod{res-list}{
      \bnfpn{res-interval} \bnfor
      \bnfpn{res-list} \bnfts{,} \bnfpn{res-interval}
      } \\
   \bnfprod{res-interval}{
      \bnfpn{res} \bnfts{:} \bnfpn{num-places} \bnfts{:} \bnfpn{stride} \bnfor
      \bnfpn{res} \bnfts{:} \bnfpn{num-places} \bnfor
      \bnfpn{res} \bnfor
      \bnfts{!} \bnfpn{res}
   } \\
   \bnfprod{aname}{
      \bnfpn{word} \bnfts{(} \bnfpn{num-places} \bnfts{)} \bnfor
      \bnfpn{word}
   } \\
   \bnfprod{word}{
      \bnfts{sockets} \bnfor
      \bnfts{cores} \bnfor
      \bnfts{threads} \bnfor
      \bnfts{<implementation-defined abstract name>}
   } \\
   \bnfprod{res}{
      \bnftd{non-negative integer}
   } \\
   \bnfprod{num-places}{
      \bnftd{positive integer}
   } \\
   \bnfprod{stride}{
      \bnftd{integer}
   } \\
   \bnfprod{len}{
      \bnftd{positive integer}
   } \\
\end{bnf*}

\pagebreak

\begin{samepage}
Examples:
\begin{boxedcode}
setenv OMP\_PLACES threads
setenv OMP\_PLACES "threads(4)"
setenv OMP\_PLACES "\{0,1,2,3\},\{4,5,6,7\},\{8,9,10,11\},\{12,13,14,15\}"
setenv OMP\_PLACES "\{0:4\},\{4:4\},\{8:4\},\{12:4\}"
setenv OMP\_PLACES "\{0:4\}:4:4"
\end{boxedcode}
\end{samepage}

where each of the last three definitions corresponds to the same 4 places including the 
smallest units of execution exposed by the execution environment numbered, in turn, 0 
to 3, 4 to 7, 8 to 11, and 12 to 15. 

\crossreferences
\begin{itemize}
\item \plc{place-partition-var}, \specref{sec:Internal Control Variables}.

\item Controlling OpenMP thread affinity, \specref{subsec:Controlling OpenMP Thread Affinity}.

\item \code{omp\_get\_num\_places} routine, see \specref{subsec:omp_get_num_places}.

\item \code{omp\_get\_place\_num\_procs} routine, see \specref{subsec:omp_get_place_num_procs}.

\item \code{omp\_get\_place\_proc\_ids} routine, see \specref{subsec:omp_get_place_proc_ids}.

\item \code{omp\_get\_place\_num} routine, see \specref{subsec:omp_get_place_num}.

\item \code{omp\_get\_partition\_num\_places} routine, see \specref{subsec:omp_get_partition_num_places}.

\item \code{omp\_get\_partition\_place\_nums} routine, see \specref{subsec:omp_get_partition_place_nums}.
\end{itemize}










\section{\code{OMP\_NESTED}}
\index{OMP\_NESTED@{\code{OMP\_NESTED}}}
\index{environment variables!OMP\_NESTED@{\code{OMP\_NESTED}}}
\label{sec:OMP_NESTED}
The deprecated \code{OMP\_NESTED} environment variable controls nested parallelism by setting the 
initial value of the \plc{nest-var} ICV. The value of this environment variable must be \code{true} 
or \code{false}. If the environment variable is set to \code{true}, nested parallelism is enabled; if 
set to \code{false}, nested parallelism is disabled. The behavior of the program is 
implementation defined if the value of \code{OMP\_NESTED} is neither \code{true} nor \code{false}.

Example:
\begin{boxedcode}
setenv OMP\_NESTED false
\end{boxedcode}

\crossreferences
\begin{itemize}
\item \plc{nest-var} ICV, see \specref{sec:Internal Control Variables}.

\item \code{omp\_set\_nested} routine, see \specref{subsec:omp_set_nested}.

\item \code{omp\_get\_team\_size} routine, see \specref{subsec:omp_get_team_size}.
\end{itemize}











\section{\code{OMP\_STACKSIZE}}
\index{OMP\_STACKSIZE@{\code{OMP\_STACKSIZE}}}
\index{environment variables!OMP\_STACKSIZE@{\code{OMP\_STACKSIZE}}}
\label{sec:OMP_STACKSIZE}
The \code{OMP\_STACKSIZE} environment variable controls the size of the stack for threads 
created by the OpenMP implementation, by setting the value of the \plc{stacksize-var} ICV. 
The environment variable does not control the size of the stack for an initial thread. 

The value of this environment variable takes the form: 

\plc{size} | \plc{size}\code{B} | \plc{size}\code{K} | \plc{size}\code{M} | \plc{size}\code{G}

where: 

\begin{itemize}
\item \plc{size} is a positive integer that specifies the size of the stack for threads that are created 
by the OpenMP implementation. 

\item \code{B}, \code{K}, \code{M}, and \code{G} are letters that specify 
whether the given size is in Bytes, Kilobytes 
(1024 Bytes), Megabytes (1024 Kilobytes), or Gigabytes (1024 Megabytes), 
respectively. If one of these letters is present, there may be white space between 
\plc{size} and the letter.
\end{itemize}

If only \plc{size} is specified and none of \code{B}, \code{K}, \code{M}, or \code{G} 
is specified, then \plc{size} is assumed to be in Kilobytes.

The behavior of the program is implementation defined if \code{OMP\_STACKSIZE} does not 
conform to the above format, or if the implementation cannot provide a stack with the 
requested size.

Examples:
\begin{boxedcode}
setenv OMP\_STACKSIZE 2000500B 
setenv OMP\_STACKSIZE "3000 k " 
setenv OMP\_STACKSIZE 10M 
setenv OMP\_STACKSIZE " 10 M "
setenv OMP\_STACKSIZE "20 m " 
setenv OMP\_STACKSIZE " 1G" 
setenv OMP\_STACKSIZE 20000 
\end{boxedcode}

\crossreferences
\begin{itemize}
\item \plc{stacksize-var} ICV, see \specref{sec:Internal Control Variables}.
\end{itemize}









\section{\code{OMP\_WAIT\_POLICY}}
\index{OMP\_WAIT\_POLICY@{\code{OMP\_WAIT\_POLICY}}}
\index{environment variables!OMP\_WAIT\_POLICY@{\code{OMP\_WAIT\_POLICY}}}
\label{sec:OMP_WAIT_POLICY}
The \code{OMP\_WAIT\_POLICY} environment variable provides a hint to an OpenMP 
implementation about the desired behavior of waiting threads by setting the 
\plc{wait-policy-var} ICV. A compliant OpenMP implementation may or may not abide by the setting of 
the environment variable.

The value of this environment variable takes the form:

\code{ACTIVE \textnormal{|} PASSIVE}

The \code{ACTIVE} value specifies that waiting threads should mostly be active, consuming 
processor cycles, while waiting. An OpenMP implementation may, for example, make 
waiting threads spin. 

The \code{PASSIVE} value specifies that waiting threads should mostly be passive, not 
consuming processor cycles, while waiting. For example, an OpenMP implementation 
may make waiting threads yield the processor to other threads or go to sleep.

The details of the \code{ACTIVE} and \code{PASSIVE} behaviors are implementation defined. 

Examples:
\begin{boxedcode}
setenv OMP\_WAIT\_POLICY ACTIVE 
setenv OMP\_WAIT\_POLICY active 
setenv OMP\_WAIT\_POLICY PASSIVE 
setenv OMP\_WAIT\_POLICY passive 
\end{boxedcode}

\crossreferences
\begin{itemize}
\item \plc{wait-policy-var} ICV, see \specref{sec:Internal Control Variables}. 
\end{itemize}










\section{\code{OMP\_MAX\_ACTIVE\_LEVELS}}
\index{OMP\_MAX\_ACTIVE\_LEVELS@{\code{OMP\_MAX\_ACTIVE\_LEVELS}}}
\index{environment variables!OMP\_MAX\_ACTIVE\_LEVELS@{\code{OMP\_MAX\_ACTIVE\_LEVELS}}}
\label{sec:OMP_MAX_ACTIVE_LEVELS}
The \code{OMP\_MAX\_ACTIVE\_LEVELS} environment variable controls the maximum number 
of nested active \code{parallel} regions by setting the initial value of the \plc{max-active-levels-var} ICV.

The value of this environment variable must be a non-negative integer. The behavior of 
the program is implementation defined if the requested value of 
\code{OMP\_MAX\_ACTIVE\_LEVELS} is greater than the maximum number of nested active 
parallel levels an implementation can support, or if the value is not a non-negative 
integer.

\crossreferences
\begin{itemize}
\item \plc{max-active-levels-var} ICV, see \specref{sec:Internal Control Variables}.

\item \code{omp\_set\_max\_active\_levels} routine, see \specref{subsec:omp_set_max_active_levels}.

\item \code{omp\_get\_max\_active\_levels} routine, see \specref{subsec:omp_get_max_active_levels}.
\end{itemize}










\section{\code{OMP\_THREAD\_LIMIT}}
\index{OMP\_THREAD\_LIMIT@{\code{OMP\_THREAD\_LIMIT}}}
\index{environment variables!OMP\_THREAD\_LIMIT@{\code{OMP\_THREAD\_LIMIT}}}
\label{sec:OMP_THREAD_LIMIT}
The \code{OMP\_THREAD\_LIMIT} environment variable sets the maximum number of OpenMP threads to use in a contention group by setting the \plc{thread-limit-var} ICV. 

The value of this environment variable must be a positive integer. The behavior of the 
program is implementation defined if the requested value of \code{OMP\_THREAD\_LIMIT} is 
greater than the number of threads an implementation can support, or if the value is not 
a positive integer. 

\crossreferences
\begin{itemize}
\item \plc{thread-limit-var} ICV, see \specref{sec:Internal Control Variables}.

\item \code{omp\_get\_thread\_limit} routine, see \specref{subsec:omp_get_thread_limit}.
\end{itemize}









\section{\code{OMP\_CANCELLATION}}
\index{OMP\_CANCELLATION@{\code{OMP\_CANCELLATION}}}
\index{environment variables!OMP\_CANCELLATION@{\code{OMP\_CANCELLATION}}}
\label{sec:OMP_CANCELLATION}
The \code{OMP\_CANCELLATION} environment variable sets the initial value of the \plc{cancel-var} 
ICV.

The value of this environment variable must be \code{true} or \code{false}. If set to \code{true}, the 
effects of the \code{cancel} construct and of cancellation points are enabled and cancellation 
is activated. If set to \code{false}, cancellation is disabled and the \code{cancel} construct and 
cancellation points are effectively ignored.

\crossreferences
\begin{itemize}
\item \plc{cancel-var}, see \specref{subsec:ICV Descriptions}.

\item \code{cancel} construct, see \specref{subsec:cancel Construct}. 

\item \code{cancellation point} construct, see \specref{subsec:cancellation point Construct}.

\item \code{omp\_get\_cancellation} routine, see \specref{subsec:omp_get_cancellation}.
\end{itemize}









\section{\code{OMP\_DISPLAY\_ENV}}
\index{OMP\_DISPLAY\_ENV@{\code{OMP\_DISPLAY\_ENV}}}
\index{environment variables!OMP\_DISPLAY\_ENV@{\code{OMP\_DISPLAY\_ENV}}}
\index{\_OPENMP@{\code{\_OPENMP} macro}}
\label{sec:OMP_DISPLAY_ENV}
The \code{OMP\_DISPLAY\_ENV} environment variable instructs the runtime to display the 
OpenMP version number and the value of the ICVs associated with the environment 
variables described in Chapter \ref{chap:Environment Variables}, 
as \plc{name} = \plc{value} pairs. The runtime displays this 
information once, after processing the environment variables and before any user calls 
to change the ICV values by runtime routines defined in Chapter \ref{chap:Runtime Library Routines}.

The value of the \code{OMP\_DISPLAY\_ENV} environment variable may be set to one of these 
values:

\code{TRUE \textnormal{|} FALSE \textnormal{|} VERBOSE}

The \code{TRUE} value instructs the runtime to display the OpenMP version number defined by 
the \code{\_OPENMP} version macro (or the \code{openmp\_version} Fortran parameter) value and 
the initial ICV values for the environment variables listed in 
Chapter \ref{chap:Environment Variables}. The \code{VERBOSE} 
value indicates that the runtime may also display the values 
of runtime variables that may be modified by vendor-specific 
environment variables. The runtime does not display any information 
when the \code{OMP\_DISPLAY\_ENV} environment variable is 
\code{FALSE} or undefined. For all values of the environment
variable other than \code{TRUE}, \code{FALSE}, and \code{VERBOSE}, 
the displayed information is unspecified.

The display begins with \texttt{"OPENMP DISPLAY ENVIRONMENT BEGIN"}, followed by 
the \code{\_OPENMP} version macro (or the \code{openmp\_version} Fortran parameter) value and 
ICV values, in the format \plc{NAME} '=' \plc{VALUE}. \plc{NAME} corresponds to the macro or 
environment variable name, optionally prepended by a bracketed \plc{device-type}. \plc{VALUE} 
corresponds to the value of the macro or ICV associated with this environment variable. 
Values should be enclosed in single quotes. The display is terminated with 
\texttt{"OPENMP DISPLAY ENVIRONMENT END"}.

Example: 
\begin{boxedcode}
\% setenv OMP\_DISPLAY\_ENV TRUE
\end{boxedcode}

The above example causes an OpenMP implementation to generate output of the 
following form:

\begin{boxedcode}
OPENMP DISPLAY ENVIRONMENT BEGIN
  \_OPENMP='201711'
  [host] OMP\_SCHEDULE='GUIDED,4'
  [host] OMP\_NUM\_THREADS='4,3,2'
  [device] OMP\_NUM\_THREADS='2'
  [host,device] OMP\_DYNAMIC='TRUE'
  [host] OMP\_PLACES='{0:4},{4:4},{8:4},{12:4}'
  ...
OPENMP DISPLAY ENVIRONMENT END
\end{boxedcode}


\section{\code{OMP\_DISPLAY\_AFFINITY}}
\index{OMP\_DISPLAY\_AFFINITY@{\code{OMP\_DISPLAY\_AFFINITY}}}
\index{environment variables!OMP\_DISPLAY\_AFFINITY@{\code{OMP\_DISPLAY\_AFFINITY}}}
\index{\_OPENMP@{\code{\_OPENMP} macro}}
\label{sec:OMP_DISPLAY_AFFINITY}
The \code{OMP\_DISPLAY\_AFFINITY} environment variable instructs the runtime to display formatted 
affinity information for OpenMP threads upon entering the first parallel region
 and when there is any change in thread affinity thereafter. 
If there is a change of affinity of any thread in a parallel region, thread affinity information for all threads
in that region will be displayed.  There is no specific order in displaying thread affinity information
for all threads in the same parallel region. 

The value of the \code{OMP\_DISPLAY\_AFFINITY} environment variable may be set to one of these 
values:

\code{TRUE \textnormal{|} FALSE}

%The default is set to \code{FALSE}.

The \code{TRUE} value instructs the runtime to display the OpenMP thread affinity information, and uses the 
format setting defined in the \plc{affinity-format-var} ICV. 

The runtime does not display the OpenMP thread affinity information when the value of the \code{OMP\_DISPLAY\_AFFINITY}
environment variable is \code{FALSE} or undefined. For all values of the environment
variable other than \code{TRUE} or \code{FALSE}, the display action is implementation defined.

Example: 
\begin{boxedcode}
setenv OMP\_DISPLAY\_AFFINITY TRUE
\end{boxedcode}

The above example causes an OpenMP implementation to display OpenMP thread affinity information during execution of
the program, in a format given by the \plc{affinity-format-var} ICV.  The following is a sample output:
\begin{boxedcode}
thread_level=   1,   thread_id=   0,   thread_affinity=    0,1  
thread_level=   1,   thread_id=   1,   thread_affinity=    2,3
\end{boxedcode}

\crossreferences
\begin{itemize}

\item Controlling OpenMP thread affinity, see 
\specref{subsec:Controlling OpenMP Thread Affinity}. 
\item \code{OMP\_AFFINITY\_FORMAT} environment variable, see 
\specref{sec:OMP_AFFINITY_FORMAT}.
\item \code{omp\_set\_affinity\_format} routine, see \specref{subsec:omp_set_affinity_format}.
\item \code{omp\_get\_affinity\_format} routine, see \specref{subsec:omp_get_affinity_format}.
\item \code{omp\_display\_affinity} routine, see \specref{subsec:omp_display_affinity}.
\item \code{omp\_capture\_affinity} routine, see \specref{subsec:omp_capture_affinity}.
\end{itemize}


\section{\code{OMP\_AFFINITY\_FORMAT}}
\index{OMP\_AFFINITY\_FORMAT@{\code{OMP\_AFFINITY\_FORMAT}}}
\index{environment variables!OMP\_AFFINITY\_FORMAT@{\code{OMP\_AFFINITY\_FORMAT}}}
\index{\_OPENMP@{\code{\_OPENMP} macro}}
\label{sec:OMP_AFFINITY_FORMAT}

The \code{OMP\_AFFINITY\_FORMAT} environment variable sets the initial value of the 
\plc{affinity-format-var} ICV which defines the format when displaying OpenMP
thread affinity information.

%The default value for \code{OMP\_AFFINITY\_FORMAT} is implementation defined.  

The value of this environment variable is a character string that may contain as
substrings one or more field specifiers, in addition to other characters.
The format of each field specifier is “\%[0[.]\plc{size}]\plc{type}”,
where an individual field specifier must contain the percent symbol (\%) and a type. 
The type can be a single character short name or its corresponding long name delimited with curly braces,
 such as “\%n” or “\%\{thread\_num\}”.
%(The “0”, “.” and \plc{size} are optional.)
A literal percent is specified as “\%\%”.  Field specifiers can be provided in any order.

The “0” indicates whether or not to add leading zeros to the output.
The “.” indicates the output should be right justified when \plc{size} is specified.
By default, output is left justified. 
The minimum field length is \plc{size}.
If no \plc{size} is specified, the actual length needed to print the field will be used. 

Any other characters in the format string that are not part of a field specifier will be included literally
in the output.

Available field types are:

% Table
\nolinenumbers
\renewcommand{\arraystretch}{1.5}
\tablefirsthead{%
\hline
\textsf{\textbf{Short Name}} & \textsf{\textbf{Long Name}} & \textsf{\textbf{Meaning}}\\
\hline \\[-3ex]
}
\tablehead{%
\multicolumn{3}{l}{\small\slshape table continued from previous page}\\
\hline
\textsf{\textbf{Short Name}} & \textsf{textbf{Long Name}} & \textsf{\textbf{Meaning}}\\
\hline \\[-3ex]
}
\tabletail{%
\hline\\[-4ex]
\multicolumn{3}{l}{\small\slshape table continued on next page}\\
}
\tablelasttail{\hline}
\tablecaption{Available Field Types for Formatting OpenMP Thread Affinity Information \label{tab:Available Field Types for Formatting OpenMP Thread Affinity Information}}
\begin{supertabular}{ p{0.06\textwidth} p{0.24\textwidth} p{0.6\textwidth}}
\code{L} & \code{thread\_level} & The value returned by \code{omp\_get\_level()}. \\
\code{n} & \code{thread\_num} &  The value returned by \code{omp\_get\_thread\_num()}. \\
\code{h} & \code{host} & The name for the host machine on which the OpenMP program is running. \\
\code{P} & \code{process\_id} & The process identifier used by the implementation. \\
\code{T} & \code{thread\_identifier} & The thread identifier for a native thread defined by the implementation. \\
\code{N} & \code{num\_threads} & The value returned by \code{omp\_get\_num\_threads()}. \\
\code{A} & \code{ancestor\_tnum} & The value returned by \code{omp\_get\_ancestor\_thread\_num(\plc{level})}, where \plc{level} is 
\code{omp\_get\_level()} minus 1. \\
\code{a} & \code{thread\_affinity} & The list of numerical identifiers, in the format of a comma-separated list of integers or integer ranges, representing processors on which a thread may execute, subject to OpenMP thread affinity control and/or other external affinity mechanisms. \\

\end{supertabular}

\linenumbers

%Often a descriptive string is used to prefix a field, as in the format  “thread\_level=\%.5L”,         
%and a comma or space is often used to separate the output of each field, as in the format 
%"thread\_num=\%0.4n affinity=\%a”. 
% A literal percent is specified as “\%\%”.  

Implementations may define additional field types.  If an implementation does not have information
for a field type, “undefined” is printed for this field when displaying the OpenMP thread affinity information.

%As an example, some compilers may wish to define field names corresponding to MPI rank information.


Example: 
\begin{boxedcode}
setenv OMP\_AFFINITY\_FORMAT 
       “Thread Affinity: %0.3L %.8n %.15\{thread_affinity\} %.12h”
\end{boxedcode}

The above example causes an OpenMP implementation to display OpenMP thread affinity information in the following form:
\begin{boxedcode}
Thread Affinity: 001        0      0-1,16-17      nid003
Thread Affinity: 001        1      2-3,18-19      nid003
\end{boxedcode}

\crossreferences
\begin{itemize}
\item Controlling OpenMP thread affinity, see 
\specref{subsec:Controlling OpenMP Thread Affinity}. 
\item \code{OMP\_DISPLAY\_AFFINITY} environment variable, see 
\specref{sec:OMP_DISPLAY_AFFINITY}.
\item \code{omp\_set\_affinity\_format} routine, see \specref{subsec:omp_set_affinity_format}.
\item \code{omp\_get\_affinity\_format} routine, see \specref{subsec:omp_get_affinity_format}.
\item \code{omp\_display\_affinity} routine, see \specref{subsec:omp_display_affinity}.
\item \code{omp\_capture\_affinity} routine, see \specref{subsec:omp_capture_affinity}.
\end{itemize}


\section{\code{OMP\_DEFAULT\_DEVICE}}
\index{OMP\_DEFAULT\_DEVICE@{\code{OMP\_DEFAULT\_DEVICE}}}
\index{environment variables!OMP\_DEFAULT\_DEVICE@{\code{OMP\_DEFAULT\_DEVICE}}}
\label{sec:OMP_DEFAULT_DEVICE}
The \code{OMP\_DEFAULT\_DEVICE} environment variable sets the device number to use in 
device constructs by setting the initial value of the \plc{default-device-var} ICV.

The value of this environment variable must be a non-negative integer value.

\crossreferences
\begin{itemize}
\item \plc{default-device-var} ICV, see \specref{sec:Internal Control Variables}.

\item device constructs, \specref{sec:Device Constructs}.
\end{itemize}


\section{\code{OMP\_MAX\_TASK\_PRIORITY}}
\index{OMP\_MAX\_TASK\_PRIORITY\_DEVICE@{\code{OMP\_MAX\_TASK\_PRIORITY}}}
\index{environment variables!OMP\_MAX\_TASK\_PRIORITY@{\code{OMP\_MAX\_TASK\_PRIORITY}}}
\label{sec:OMP_MAX_TASK_PRIORITY}

The \code{OMP\_MAX\_TASK\_PRIORITY} environment variable controls the use of task
priorities by setting the initial value of the \plc{max-task-priority-var} ICV. The
value of this environment variable must be a non-negative integer. 

Example:
\begin{boxedcode}
\% setenv OMP\_MAX\_TASK\_PRIORITY 20
\end{boxedcode}

\crossreferences
\begin{itemize}
\item \plc{max-task-priority-var} ICV, see \specref{sec:Internal Control Variables}.
\item Tasking Constructs, see \specref{sec:Tasking Constructs}.
\item \code{omp\_get\_max\_task\_priority} routine, see \specref{subsec:omp_get_max_task_priority}.
\end{itemize}




\section{\code{OMP\_TARGET\_OFFLOAD}}
\index{OMP\_TARGET\_OFFLOAD@{\code{OMP\_TARGET\_OFFLOAD}}}
\index{environment variables!OMP\_TARGET\_OFFLOAD@{\code{OMP\_TARGET\_OFFLOAD}}}
\label{sec:OMP_TARGET_OFFLOAD}
%
The \code{OMP\_TARGET\_OFFLOAD} environment variable sets the initial value of the \plc{target-offload-var} ICV.
The value of the \code{OMP\_TARGET\_OFFLOAD} environment variable may be set to one of these 
values:

\code{MANDATORY \textnormal{|}  DISABLED \textnormal{|} DEFAULT }

The \code{MANDATORY} value specifies that a device construct or a device memory routine must execute on a target device. If the device construct cannot execute on its target device, or if a device memory routine fails to execute, a warning is issued and the program execution aborts. Device constructs are exempt from this behavior when an if-clause is present and the if-clause expression evaluates to false. 

The support of \code{DISABLED}  is implementation defined. If an implementation supports it, the behavior should be that a device construct must execute on the host.  The behavior with this environment value is equivalent to an if clause present on all device constructs, where each of these if clause expressions evaluate to false. Device memory routines behave as if all device number parameters are set to the value returned by \code{omp\_get\_initial\_device()}. The \code{omp\_get\_initial\_device()} routine returns that no target device is available

The \code{DEFAULT} value specifies that when one or more target devices are available, the runtime behaves as if this environment variable is set to \code{MANDATORY}; otherwise, the runtime behaves as if this environment variable is set to \code{DISABLED}.

Example:
\begin{boxedcode}
\% setenv OMP\_TARGET\_OFFLOAD MANDATORY
\end{boxedcode}

\crossreferences
\begin{itemize}
\item \plc{target-offload-icv} ICV, see \specref{sec:Internal Control Variables}.
\item device constructs, \specref{sec:Device Constructs}.
\end{itemize}




\section{\code{OMP\_TOOL}}
\index{OMP\_TOOL@{\code{OMP\_TOOL}}}
\index{environment variables!OMP\_TOOL@{\code{OMP\_TOOL}}}
\label{sec:OMP_TOOL}

The \code{OMP\_TOOL} environment variable sets the \plc{tool-var} ICV which controls whether an OpenMP runtime will try to register a
first party tool.
The value of this environment variable must be \code{enabled} or \code{disabled}.
If \code{OMP\_TOOL} is set to any value other than \code{enabled} or \code{disabled}, the behavior is unspecified.
If \code{OMP\_TOOL} is not defined, the default value for \plc{tool-var} is \code{enabled}.

Example:
\begin{boxedcode}
\% setenv OMP\_TOOL enabled
\end{boxedcode}

\crossreferences
\begin{itemize}
\item \plc{tool-var} ICV, see \specref{sec:Internal Control Variables}.
\item Tool Interface, see \specref{chap:ToolsSupport}.
\end{itemize}




\section{\code{OMP\_TOOL\_LIBRARIES}}
\index{OMP\_TOOL\_LIBRARIES@{\code{OMP\_TOOL\_LIBRARIES}}}
\index{environment variables!OMP\_TOOL\_LIBRARIES@{\code{OMP\_TOOL\_LIBRARIES}}}
\label{sec:OMP_TOOL_LIBRARIES}

The \code{OMP\_TOOL\_LIBRARIES} environment variable sets the
\plc{tool-libraries-var} ICV to a list of tool libraries that will
be considered for use on a device where an OpenMP implementation
is being initialized.  The value of this environment variable must
be a colon-separated list of dynamically-linked libraries, each
specified by an absolute path. 

If the \plc{tool-var} ICV is not enabled, 
the value of \plc{tool-libraries-var} will be ignored.
Otherwise, if \code{ompt\_start\_tool}, a global function symbol for a tool initializer,
isn't visible in the address space on a device where OpenMP is being
initialized or if \code{ompt\_start\_tool} returns \code{NULL}, an OpenMP implementation 
will consider libraries in the \plc{tool-libraries-var} list 
in a left to right order.  The OpenMP implementation will search the list for 
a library that meets two criteria: it can be dynamically
loaded on the current device and it defines the symbol \code{ompt\_start\_tool}.
If an OpenMP implementation finds a suitable library, 
no further libraries in the list will be considered.

\crossreferences
\begin{itemize}
\item \plc{tool-libraries-var} ICV, see \specref{sec:Internal Control Variables}.
\item Tool Interface, see \specref{chap:ToolsSupport}.
\item \code{ompt\_start\_tool} routine, see \specref{sec:ompt_start_tool}.
\end{itemize}

\section{\code{OMPD\_ENABLED}}
\index{OMPD\_ENABLED@{\code{OMPD\_ENABLED}}}
\index{environment variables!OMPD\_ENABLED@{\code{OMPD\_ENABLED}}}
\label{sec:OMPD_ENABLED}

The \code{OMPD\_ENABLED} environment variable sets the
\plc{ompd-tool-var} ICV which controls whether an OpenMP runtime
will collect information that an OMPD plugin may need to support
a tool.
The value of this environment variable must be \code{enabled}
or \code{disabled}.
If \code{OMPD\_ENABLED} is set to any value other than \code{enabled}
or \code{disabled}, the behavior is unspecified.
If \code{OMPD\_ENABLED} is not defined, the default value for
\plc{ompd-tool-var} is \code{disabled}.

Example:
\begin{boxedcode}
\% setenv OMPD\_ENABLED enabled
\end{boxedcode}

\crossreferences
\begin{itemize}
\item \plc{ompd-tool-var} ICV,
see \specref{sec:Internal Control Variables}.
\item \code{ompd\_enable}, see \specref{ompd:ompd_enable}
\item Tool Interface, see \specref{chap:ToolsSupport}
\item Enabling the Runtime for OMPD, see \specref{ompd:enabling-ompd}.
\end{itemize}


\section{\code{OMP\_ALLOCATOR}}
\index{OMP\_ALLOCATOR@{\code{OMP\_ALLOCATOR}}}
\index{environment variables!OMP\_ALLOCATOR@{\code{OMP\_ALLOCATOR}}}
\label{sec:OMP_ALLOCATOR}

\code{OMP\_ALLOCATOR} sets the \plc{def-allocator-var} ICV that specifies the default 
allocator for allocation calls, directives and clauses that do not specify an allocator. 
The value of this environment variable is a predefined allocator from \tabref{tab:Predefined Allocators}. The value of this environment variable is not case sensitive.

\crossreferences
\begin{itemize}
\item \plc{def-allocator-var} ICV, see \specref{sec:Internal Control Variables}.

\item Memory Allocators, see \specref{sec:Memory Allocators}.

\item \code{omp\_set\_default\_allocator} routine, see \specref{subsec:omp_set_default_allocator}.

\item \code{omp\_get\_default\_allocator} routine, see \specref{subsec:omp_get_default_allocator}.
\end{itemize}


% This is the end of ch5-environmentVariables.tex

