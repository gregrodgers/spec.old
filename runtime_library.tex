% This is runtime_library.tex (Chapter 3) of the OpenMP specification.
% This is an included file. See the master file for more information.
%
% When editing this file:
%
%    1. To change formatting, appearance, or style, please edit openmp.sty.
%
%    2. Custom commands and macros are defined in openmp.sty.
%
%    3. Be kind to other editors -- keep a consistent style by copying-and-pasting to
%       create new content.
%
%    4. We use semantic markup, e.g. (see openmp.sty for a full list):
%         \code{}     % for bold monospace keywords, code, operators, etc.
%         \plc{}      % for italic placeholder names, grammar, etc.
%
%    5. There are environments that provide special formatting, e.g. language bars.
%       Please use them whereever appropriate.  Examples are:
%
%         \begin{fortranspecific}
%         This is text that appears enclosed in blue language bars for Fortran.
%         \end{fortranspecific}
%
%         \begin{note}
%         This is a note.  The "Note -- " header appears automatically.
%         \end{note}
%
%    6. Other recommendations:
%         Use the convenience macros defined in openmp.sty for the minor headers
%         such as Comments, Syntax, etc.
%
%         To keep items together on the same page, prefer the use of
%         \begin{samepage}.... Avoid \parbox for text blocks as it interrupts line numbering.
%         When possible, avoid \filbreak, \pagebreak, \newpage, \clearpage unless that's
%         what you mean. Use \needspace{} cautiously for troublesome paragraphs.
%
%         Avoid absolute lengths and measures in this file; use relative units when possible.
%         Vertical space can be relative to \baselineskip or ex units. Horizontal space
%         can be relative to \linewidth or em units.
%
%         Prefer \emph{} to italicize terminology, e.g.:
%             This is a \emph{definition}, not a placeholder.
%             This is a \plc{var-name}.
%

\chapter{Runtime Library Routines}
\index{runtime library routines}
\label{chap:Runtime Library Routines}
This chapter describes the OpenMP API runtime library routines and 
queryable runtime states. In this chapter, \plc{true} and \plc{false} 
are used as generic terms to simplify the description of the routines.

\begin{samepage}
\begin{ccppspecific}
\plc{true} means a nonzero integer value and \plc{false} means 
an integer value of zero.
\end{ccppspecific}
\end{samepage}
\bigskip

\begin{samepage}
\begin{fortranspecific}
\plc{true} means a logical value of \code{.TRUE.} and \plc{false} 
means a logical value of \code{.FALSE.}.
\end{fortranspecific}
\end{samepage}
\bigskip

\begin{samepage}

\begin{fortranspecific}
\vspace{-3ex}  %% HACK
\restrictions
The following restriction applies to all OpenMP runtime library routines:

\begin{itemize}
\item OpenMP runtime library routines may not be called 
      from \code{PURE} or \code{ELEMENTAL} procedures.
\end{itemize}
\end{fortranspecific}
\end{samepage}



\section{Runtime Library Definitions}
\index{runtime library definitions}
\index{header files}
\index{include files}
\label{sec:runtime library definitions}
For each base language, a compliant implementation must supply a set of 
definitions for the OpenMP API runtime library routines and the special 
data types of their parameters. The set of definitions must contain a 
declaration for each OpenMP API runtime library routine and variable and 
a definition of each required data type listed below. In addition, each 
set of definitions may specify other implementation specific values.

\begin{ccppspecific}
The library routines are external functions with ``C'' linkage.

Prototypes for the C/C++ runtime library routines described in this 
chapter shall be provided in a header file named \code{omp.h}. This 
file also defines the following:

\begin{itemize}
\item The type \code{omp_lock_t};
\item The type \code{omp_nest_lock_t};
\item The type \code{omp_sync_hint_t};
\item The type \code{omp_lock_hint_t} (deprecated);
\item The type \code{omp_sched_t};
\item The type \code{omp_proc_bind_t};
\item The type \code{omp_control_tool_t};
\item The type \code{omp_control_tool_result_t};
\item The type \code{omp_depend_t};
\item The type \code{omp_memspace_handle_t}, which must be an 
      implementation-defined enum type with an enumerator for 
      at least each predefined memory space in 
      \tabref{tab:Predefined Memory Spaces};
\item The type \code{omp_allocator_handle_t}, which must be an
      implementation-defined enum type with at least the 
      \code{OMP_NULL_ALLOCATOR} enumerator with the value 
      zero and an enumerator for each predefined memory allocator 
      in \tabref{tab:Predefined Allocators};
\item The type \code{omp_uintptr_t}, which is an unsigned integer type 
      capable of holding a pointer on any device;
\item The type \code{omp_pause_resource_t}; and
\item The type \code{omp_event_handle_t}, which must be an 
      implementation-defined enum type.
\end{itemize}
\end{ccppspecific}

\begin{cppspecific}
The \code{omp.h} header file also defines a class template that
models the \code{Allocator} concept in the \code{omp::allocator}
namespace for each predefined memory allocator in
\tabref{tab:Predefined Allocators} for which the name includes
neither the \code{omp_} prefix nor the \code{_alloc} suffix.
\end{cppspecific}

\begin{fortranspecific}
The OpenMP Fortran API runtime library routines are external procedures. The 
return values of these routines are of default kind, unless otherwise specified.

Interface declarations for the OpenMP Fortran runtime library routines 
described in this chapter shall be provided in the form of a Fortran 
\code{include} file named \code{omp_lib.h} or a Fortran~90 \code{module} 
named \code{omp_lib}. It is implementation defined whether the
\code{include} file or the \code{module} file (or both) is provided.

These files also define the following:

\begin{itemize}
\item The \code{integer} \code{parameter} \code{omp_lock_kind};
\item The \code{integer} \code{parameter} \code{omp_nest_lock_kind};
\item The \code{integer} \code{parameter} \code{omp_sync_hint_kind};
\item The \code{integer} \code{parameter} \code{omp_lock_hint_kind} (deprecated);
\item The \code{integer} \code{parameter} \code{omp_sched_kind};
\item The \code{integer} \code{parameter} \code{omp_proc_bind_kind};
\item The \code{integer} \code{parameter} \code{omp_control_tool_kind};
\item The \code{integer} \code{parameter} \code{omp_control_tool_result_kind};
\item The \code{integer} \code{parameter} \code{omp_depend_kind};
\item The \code{integer} \code{parameter} \code{omp_memspace_handle_kind};
\item The \code{integer} \code{parameter} \code{omp_allocator_handle_kind};
\item The \code{integer} \code{parameter} \code{omp_alloctrait_key_kind};
\item The \code{integer} \code{parameter} \code{omp_alloctrait_val_kind};
\item An \code{integer} \code{parameter} of kind \code{omp_memspace_handle_kind} 
      for each predefined memory space in \tabref{tab:Predefined Memory Spaces};
\item An \code{integer} \code{parameter} of kind \code{omp_allocator_handle_kind} 
      for each predefined memory allocator in \tabref{tab:Predefined Allocators};
\item The \code{integer} \code{parameter} \code{omp_pause_kind};
\item The \code{integer} \code{parameter} \code{omp_event_handle_kind}; and
\item The \code{integer} \code{parameter} \code{openmp_version} with a value 
      \plc{yyyymm} where \plc{yyyy} and \plc{mm} are the year and month designations 
      of the version of the OpenMP Fortran API that the implementation supports; 
      this value matches that of the C preprocessor macro \code{_OPENMP}, when a 
      macro preprocessor is supported (see \specref{sec:Conditional Compilation}).
\end{itemize}

It is implementation defined whether any of the OpenMP runtime library 
routines that take an argument are extended with a generic interface so 
arguments of different \code{KIND} type can be accommodated. 
\end{fortranspecific}

\input{runtime_library/runtime_library_execution}
\input{runtime_library/runtime_library_others}
\input{runtime_library/runtime_library_device_mem}
\input{runtime_library/runtime_library_mm}
\input{runtime_library/runtime_library_tools}

