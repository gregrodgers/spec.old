\subsection{Thread States}
\label{sec:thread-states}
\label{sec:ompt_state_t}

\summary
If the OMPT interface is in the \plc{active} state then an OpenMP implementation
must maintain \plc{thread state} information for each thread. The thread 
state maintained is an approximation of the instantaneous state of a thread.

\format
\begin{ccppspecific}
A thread state must be one of the values of the enumeration type 
\code{ompt_state_t} or an implementation-defined state value of 512 or higher.

\begin{ompcEnum}
typedef enum ompt_state_t {
  ompt_state_work_serial                      = 0x000,
  ompt_state_work_parallel                    = 0x001,
  ompt_state_work_reduction                   = 0x002,

  ompt_state_wait_barrier                     = 0x010,
  ompt_state_wait_barrier_implicit_parallel   = 0x011,
  ompt_state_wait_barrier_implicit_workshare  = 0x012,
  ompt_state_wait_barrier_implicit            = 0x013,
  ompt_state_wait_barrier_explicit            = 0x014,

  ompt_state_wait_taskwait                    = 0x020,
  ompt_state_wait_taskgroup                   = 0x021,

  ompt_state_wait_mutex                       = 0x040,
  ompt_state_wait_lock                        = 0x041,
  ompt_state_wait_critical                    = 0x042,
  ompt_state_wait_atomic                      = 0x043,
  ompt_state_wait_ordered                     = 0x044,

  ompt_state_wait_target                      = 0x080,
  ompt_state_wait_target_map                  = 0x081,
  ompt_state_wait_target_update               = 0x082,

  ompt_state_idle                             = 0x100,
  ompt_state_overhead                         = 0x101,
  ompt_state_undefined                        = 0x102
} ompt_state_t;
\end{ompcEnum}
\end{ccppspecific}

\descr
A tool can query the OpenMP state of a thread at any time. If a 
tool queries the state of a thread that is not associated with OpenMP
then the implementation reports the state as \code{ompt_state_undefined}.

The value \code{ompt_state_work_serial} indicates that the thread 
is executing code outside all parallel regions.

The value \code{ompt_state_work_parallel} indicates that the thread 
is executing code within the scope of a parallel region construct.

The value \code{ompt_state_work_reduction} indicates that the thread 
is combining partial reduction results from threads in its team. An 
OpenMP implementation might never report a thread in this state; a 
thread combining partial reduction results may have its state reported 
as \code{ompt_state_work_parallel} or \code{ompt_state_overhead}.

The value \code{ompt_state_wait_barrier} indicates that the thread is 
waiting at either an implicit or explicit barrier. An implementation 
may never report a thread in this state; instead, a thread may have its 
state reported as \code{ompt_state_wait_barrier_implicit}  or 
\code{ompt_state_wait_barrier_explicit}, as appropriate.

The value \code{ompt_state_wait_barrier_implicit} indicates that the 
thread is waiting at an implicit barrier in a parallel region. An 
OpenMP implementation may report \code{ompt_state_wait_barrier} for 
implicit barriers.

The value \code{ompt_state_wait_barrier_implicit_parallel} indicates 
that the thread is waiting at an implicit barrier at the end of a parallel 
region. An OpenMP implementation may report \code{ompt_state_wait_barrier} 
or \code{ompt_state_wait_barrier_implicit} for these barriers.

The value \code{ompt_state_wait_barrier_implicit_workshare}  indicates 
that the thread is waiting at an implicit barrier at the end of a 
workshare-construct. An OpenMP implementation may report 
\code{ompt_state_wait_barrier} or \code{ompt_state_wait_barrier_implicit} 
for these barriers.

The value \code{ompt_state_wait_barrier_explicit} indicates that the 
thread is waiting in a \code{barrier} region. An OpenMP implementation
may report \code{ompt_state_wait_barrier} for these barriers.

The value \code{ompt_state_wait_taskwait} indicates that the thread is 
waiting at a taskwait construct. 

The value \code{ompt_state_wait_taskgroup} indicates that the thread is 
waiting at the end of a taskgroup construct. 

The value \code{ompt_state_wait_mutex} indicates that the thread is waiting 
for a mutex of an unspecified type. 

The value \code{ompt_state_wait_lock} indicates that the thread is waiting 
for a  lock or nest lock. 

The value \code{ompt_state_wait_critical} indicates that the thread is 
waiting to enter a critical region. 

The value \code{ompt_state_wait_atomic} indicates that the thread is 
waiting to enter an atomic region. 

The value \code{ompt_state_wait_ordered} indicates that the thread is 
waiting to enter an ordered region. 


The value \code{ompt_state_wait_target} indicates that the thread is 
waiting for a target region to complete.

The value \code{ompt_state_wait_target_map} indicates that the thread 
is waiting for a target data mapping operation to complete. An implementation 
may report \code{ompt_state_wait_target} for target data constructs.

The value \code{ompt_state_wait_target_update} indicates that the thread 
is waiting for a target  update operation to complete. An implementation 
may report \code{ompt_state_wait_target} for target update constructs.

The value \code{ompt_state_idle} indicates that the thread is idle, that 
is not part of an OpenMP team.

The value \code{ompt_state_overhead} indicates that the thread is in the 
overhead state at any point while executing within an OpenMP runtime, 
except while waiting indefinitely at a synchronization point.

The value \code{ompt_state_undefined} indicates that the native thread is 
not created by the OpenMP implementation.

